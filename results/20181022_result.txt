Start of evolution
0 None
1 None
2 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 14s 242us/step - loss: 0.8566 - acc: 0.7412 - val_loss: 0.4301 - val_acc: 0.8663
Epoch 2/3
60000/60000 [==============================] - 13s 217us/step - loss: 0.2785 - acc: 0.9176 - val_loss: 0.2248 - val_acc: 0.9316
Epoch 3/3
60000/60000 [==============================] - 13s 218us/step - loss: 0.1703 - acc: 0.9484 - val_loss: 0.1634 - val_acc: 0.9519
Test loss: 0.16340456176549195
Test accuracy: 0.9519
0 None
1 None
2 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 14s 228us/step - loss: 0.7376 - acc: 0.7780 - val_loss: 0.3528 - val_acc: 0.8911
Epoch 2/3
60000/60000 [==============================] - 13s 217us/step - loss: 0.2625 - acc: 0.9227 - val_loss: 0.2008 - val_acc: 0.9372
Epoch 3/3
60000/60000 [==============================] - 13s 217us/step - loss: 0.1819 - acc: 0.9453 - val_loss: 0.1851 - val_acc: 0.9418
Test loss: 0.18511725452542305
Test accuracy: 0.9418
0 None
1 None
2 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 14s 228us/step - loss: 0.6969 - acc: 0.7942 - val_loss: 0.3913 - val_acc: 0.8781
Epoch 2/3
60000/60000 [==============================] - 13s 215us/step - loss: 0.2285 - acc: 0.9337 - val_loss: 0.1983 - val_acc: 0.9394
Epoch 3/3
60000/60000 [==============================] - 13s 217us/step - loss: 0.1547 - acc: 0.9536 - val_loss: 0.1590 - val_acc: 0.9506
Test loss: 0.15899194033294917
Test accuracy: 0.9506
0 None
1 None
2 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 14s 231us/step - loss: 0.7711 - acc: 0.7629 - val_loss: 0.3787 - val_acc: 0.8863
Epoch 2/3
60000/60000 [==============================] - 13s 218us/step - loss: 0.2651 - acc: 0.9218 - val_loss: 0.1879 - val_acc: 0.9444
Epoch 3/3
60000/60000 [==============================] - 13s 219us/step - loss: 0.1681 - acc: 0.9498 - val_loss: 0.1454 - val_acc: 0.9595
Test loss: 0.14539003223627806
Test accuracy: 0.9595
0 None
1 None
2 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 14s 235us/step - loss: 0.6826 - acc: 0.7908 - val_loss: 0.2917 - val_acc: 0.9094
Epoch 2/3
60000/60000 [==============================] - 13s 216us/step - loss: 0.2304 - acc: 0.9324 - val_loss: 0.1881 - val_acc: 0.9419
Epoch 3/3
60000/60000 [==============================] - 13s 217us/step - loss: 0.1609 - acc: 0.9515 - val_loss: 0.1706 - val_acc: 0.9446
Test loss: 0.17057196242809294
Test accuracy: 0.9446
0 None
1 None
2 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 14s 233us/step - loss: 0.8190 - acc: 0.7413 - val_loss: 0.3911 - val_acc: 0.8752
Epoch 2/3
60000/60000 [==============================] - 13s 217us/step - loss: 0.2713 - acc: 0.9200 - val_loss: 0.2740 - val_acc: 0.9147
Epoch 3/3
60000/60000 [==============================] - 13s 217us/step - loss: 0.1789 - acc: 0.9459 - val_loss: 0.1546 - val_acc: 0.9527
Test loss: 0.1546437857106328
Test accuracy: 0.9527
0 None
1 None
2 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 14s 236us/step - loss: 0.8338 - acc: 0.7602 - val_loss: 0.3111 - val_acc: 0.9120
Epoch 2/3
60000/60000 [==============================] - 13s 218us/step - loss: 0.2456 - acc: 0.9247 - val_loss: 0.2226 - val_acc: 0.9280
Epoch 3/3
60000/60000 [==============================] - 13s 219us/step - loss: 0.1677 - acc: 0.9492 - val_loss: 0.1532 - val_acc: 0.9521
Test loss: 0.15321655700840056
Test accuracy: 0.9521
0 None
1 None
2 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 15s 245us/step - loss: 0.7681 - acc: 0.7692 - val_loss: 0.4269 - val_acc: 0.8649
Epoch 2/3
60000/60000 [==============================] - 13s 223us/step - loss: 0.2609 - acc: 0.9231 - val_loss: 0.1902 - val_acc: 0.9447
Epoch 3/3
60000/60000 [==============================] - 13s 218us/step - loss: 0.1805 - acc: 0.9457 - val_loss: 0.1717 - val_acc: 0.9472
Test loss: 0.17173651725277306
Test accuracy: 0.9472
0 None
1 None
2 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 14s 241us/step - loss: 0.6949 - acc: 0.7871 - val_loss: 0.3020 - val_acc: 0.9122
Epoch 2/3
60000/60000 [==============================] - 13s 217us/step - loss: 0.2352 - acc: 0.9295 - val_loss: 0.2605 - val_acc: 0.9140
Epoch 3/3
60000/60000 [==============================] - 13s 217us/step - loss: 0.1593 - acc: 0.9518 - val_loss: 0.1397 - val_acc: 0.9585
Test loss: 0.13967271143123508
Test accuracy: 0.9585
0 None
1 None
2 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 15s 242us/step - loss: 0.7186 - acc: 0.7852 - val_loss: 0.2867 - val_acc: 0.9150
Epoch 2/3
60000/60000 [==============================] - 13s 218us/step - loss: 0.2427 - acc: 0.9284 - val_loss: 0.1949 - val_acc: 0.9399
Epoch 3/3
60000/60000 [==============================] - 13s 219us/step - loss: 0.1633 - acc: 0.9515 - val_loss: 0.1477 - val_acc: 0.9580
Test loss: 0.1476571826465428
Test accuracy: 0.958
  Evaluated 10 individuals
-- Generation 0 --
[<__main__.SerializedLayer object at 0x7f8b3f2f8908>, <__main__.SerializedLayer object at 0x7f8b3f2f8ba8>, <__main__.SerializedLayer object at 0x7f8b3f2f8e48>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
1 2
0 1
[<__main__.SerializedLayer object at 0x7f8b3f280ac8>, <__main__.SerializedLayer object at 0x7f8b3f280d68>, <__main__.SerializedLayer object at 0x7f8b3f283048>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
1 1
0 0
0 None
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 144, in remove_skip
    ind.remove_layer('Add')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Add layer is found.
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 119, in add_dropout
    fc_layer = ind.sample_layer('Dense')
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Dense layer is found.
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 144, in remove_skip
    ind.remove_layer('Add')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Add layer is found.
1 None
2 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 15s 247us/step - loss: 0.6181 - acc: 0.8328 - val_loss: 0.4432 - val_acc: 0.8509
Epoch 2/3
60000/60000 [==============================] - 13s 218us/step - loss: 0.1697 - acc: 0.9515 - val_loss: 0.1386 - val_acc: 0.9562
Epoch 3/3
60000/60000 [==============================] - 13s 218us/step - loss: 0.1132 - acc: 0.9669 - val_loss: 0.1333 - val_acc: 0.9605
Test loss: 0.13330535738617183
Test accuracy: 0.9605
0 None
1 None
2 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 14s 226us/step - loss: 0.8592 - acc: 0.7350 - val_loss: 0.5104 - val_acc: 0.8371
Epoch 2/3
60000/60000 [==============================] - 11s 189us/step - loss: 0.3247 - acc: 0.9018 - val_loss: 0.3241 - val_acc: 0.8994
Epoch 3/3
60000/60000 [==============================] - 11s 189us/step - loss: 0.2138 - acc: 0.9349 - val_loss: 0.2415 - val_acc: 0.9225
Test loss: 0.24148846073746683
Test accuracy: 0.9225
0 None
1 None
2 1
3 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 15s 254us/step - loss: 0.8041 - acc: 0.7566 - val_loss: 0.4125 - val_acc: 0.8743
Epoch 2/3
60000/60000 [==============================] - 13s 224us/step - loss: 0.2426 - acc: 0.9282 - val_loss: 0.1837 - val_acc: 0.9419
Epoch 3/3
60000/60000 [==============================] - 13s 223us/step - loss: 0.1605 - acc: 0.9513 - val_loss: 0.1448 - val_acc: 0.9552
Test loss: 0.14475284907370806
Test accuracy: 0.9552
0 None
1 None
2 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 13s 220us/step - loss: 0.7476 - acc: 0.7796 - val_loss: 0.4070 - val_acc: 0.8839
Epoch 2/3
60000/60000 [==============================] - 11s 186us/step - loss: 0.2333 - acc: 0.9320 - val_loss: 0.1835 - val_acc: 0.9423
Epoch 3/3
60000/60000 [==============================] - 11s 186us/step - loss: 0.1595 - acc: 0.9526 - val_loss: 0.3183 - val_acc: 0.8988
Test loss: 0.31827694345414637
Test accuracy: 0.8988
0 None
1 None
2 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 19s 325us/step - loss: 0.7580 - acc: 0.7749 - val_loss: 0.3185 - val_acc: 0.9075
Epoch 2/3
60000/60000 [==============================] - 17s 286us/step - loss: 0.2263 - acc: 0.9328 - val_loss: 0.1805 - val_acc: 0.9453
Epoch 3/3
60000/60000 [==============================] - 17s 287us/step - loss: 0.1482 - acc: 0.9553 - val_loss: 0.1493 - val_acc: 0.9540
Test loss: 0.14927789545953274
Test accuracy: 0.954
0 None
1 None
2 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 14s 233us/step - loss: 1.0785 - acc: 0.6557 - val_loss: 0.5522 - val_acc: 0.8221
Epoch 2/3
60000/60000 [==============================] - 12s 192us/step - loss: 0.4456 - acc: 0.8590 - val_loss: 0.3316 - val_acc: 0.8988
Epoch 3/3
60000/60000 [==============================] - 12s 193us/step - loss: 0.3188 - acc: 0.9003 - val_loss: 0.2744 - val_acc: 0.9152
Test loss: 0.27436620631217956
Test accuracy: 0.9152
0 None
1 0
2 None
3 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 15s 256us/step - loss: 0.7465 - acc: 0.7764 - val_loss: 0.3521 - val_acc: 0.8933
Epoch 2/3
60000/60000 [==============================] - 13s 216us/step - loss: 0.2617 - acc: 0.9217 - val_loss: 0.2069 - val_acc: 0.9375
Epoch 3/3
60000/60000 [==============================] - 13s 216us/step - loss: 0.1717 - acc: 0.9494 - val_loss: 0.1540 - val_acc: 0.9517
Test loss: 0.15399467898607255
Test accuracy: 0.9517
0 None
1 None
2 None
3 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 18s 308us/step - loss: 0.7882 - acc: 0.7659 - val_loss: 0.3298 - val_acc: 0.9000
Epoch 2/3
60000/60000 [==============================] - 16s 264us/step - loss: 0.2114 - acc: 0.9374 - val_loss: 0.2015 - val_acc: 0.9345
Epoch 3/3
60000/60000 [==============================] - 16s 265us/step - loss: 0.1461 - acc: 0.9559 - val_loss: 0.1238 - val_acc: 0.9595
Test loss: 0.12376943442597985
Test accuracy: 0.9595
0 None
1 None
2 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 16s 268us/step - loss: 0.5097 - acc: 0.8583 - val_loss: 0.2574 - val_acc: 0.9270
Epoch 2/3
60000/60000 [==============================] - 13s 218us/step - loss: 0.1544 - acc: 0.9563 - val_loss: 0.1210 - val_acc: 0.9651
Epoch 3/3
60000/60000 [==============================] - 13s 218us/step - loss: 0.0989 - acc: 0.9719 - val_loss: 0.0898 - val_acc: 0.9739
Test loss: 0.08984061306566
Test accuracy: 0.9739
  Evaluated 9 individuals
-- Generation 1 --
[<__main__.SerializedLayer object at 0x7f8b38cedbe0>, <__main__.SerializedLayer object at 0x7f8b38cede80>, <__main__.SerializedLayer object at 0x7f8b38cf0160>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
1 2
0 1
[<__main__.SerializedLayer object at 0x7f8b38cf2518>, <__main__.SerializedLayer object at 0x7f8b38cf27b8>, <__main__.SerializedLayer object at 0x7f8b38cf2a58>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
1 1
0 0
0 None
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 153, in remove_concatenate
    ind.remove_layer('Concatenate')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Concatenate layer is found.
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 169, in remove_fully_connected
    ind.remove_layer('Dense')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Dense layer is found.
1 None
2 1
3 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 16s 268us/step - loss: 0.5342 - acc: 0.8569 - val_loss: 0.3143 - val_acc: 0.9039
Epoch 2/3
60000/60000 [==============================] - 13s 223us/step - loss: 0.1509 - acc: 0.9577 - val_loss: 0.1100 - val_acc: 0.9686
Epoch 3/3
60000/60000 [==============================] - 13s 223us/step - loss: 0.0970 - acc: 0.9721 - val_loss: 0.0984 - val_acc: 0.9690
Test loss: 0.09838599095121026
Test accuracy: 0.969
0 None
1 None
2 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 16s 269us/step - loss: 0.4024 - acc: 0.8927 - val_loss: 0.1456 - val_acc: 0.9559
Epoch 2/3
60000/60000 [==============================] - 13s 219us/step - loss: 0.1090 - acc: 0.9684 - val_loss: 0.0812 - val_acc: 0.9767
Epoch 3/3
60000/60000 [==============================] - 13s 219us/step - loss: 0.0720 - acc: 0.9786 - val_loss: 0.0698 - val_acc: 0.9778
Test loss: 0.06984976690299809
Test accuracy: 0.9778
0 None
1 None
2 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 16s 270us/step - loss: 0.5861 - acc: 0.8356 - val_loss: 0.2499 - val_acc: 0.9239
Epoch 2/3
60000/60000 [==============================] - 13s 218us/step - loss: 0.1474 - acc: 0.9579 - val_loss: 0.1329 - val_acc: 0.9640
Epoch 3/3
60000/60000 [==============================] - 13s 218us/step - loss: 0.0975 - acc: 0.9719 - val_loss: 0.0869 - val_acc: 0.9744
Test loss: 0.08691102781035007
Test accuracy: 0.9744
0 None
1 0
2 None
3 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 16s 275us/step - loss: 0.5995 - acc: 0.8311 - val_loss: 0.2405 - val_acc: 0.9269
Epoch 2/3
60000/60000 [==============================] - 13s 221us/step - loss: 0.1454 - acc: 0.9597 - val_loss: 0.1442 - val_acc: 0.9567
Epoch 3/3
60000/60000 [==============================] - 13s 221us/step - loss: 0.0979 - acc: 0.9717 - val_loss: 0.0820 - val_acc: 0.9753
Test loss: 0.08195388890504837
Test accuracy: 0.9753
0 None
1 None
2 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 17s 276us/step - loss: 0.4334 - acc: 0.8749 - val_loss: 0.2559 - val_acc: 0.9254
Epoch 2/3
60000/60000 [==============================] - 13s 219us/step - loss: 0.1291 - acc: 0.9635 - val_loss: 0.1263 - val_acc: 0.9637
Epoch 3/3
60000/60000 [==============================] - 13s 219us/step - loss: 0.0860 - acc: 0.9752 - val_loss: 0.0813 - val_acc: 0.9766
Test loss: 0.0813372857093811
Test accuracy: 0.9766
0 None
1 None
2 None
3 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 21s 357us/step - loss: 0.4739 - acc: 0.8752 - val_loss: 0.1256 - val_acc: 0.9626
Epoch 2/3
60000/60000 [==============================] - 18s 296us/step - loss: 0.0979 - acc: 0.9718 - val_loss: 0.1555 - val_acc: 0.9518
Epoch 3/3
60000/60000 [==============================] - 18s 296us/step - loss: 0.0677 - acc: 0.9802 - val_loss: 0.0593 - val_acc: 0.9809
Test loss: 0.05934533234108239
Test accuracy: 0.9809
0 None
1 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 12s 207us/step - loss: 1.0411 - acc: 0.6723 - val_loss: 0.6281 - val_acc: 0.7992
Epoch 2/3
60000/60000 [==============================] - 9s 149us/step - loss: 0.4826 - acc: 0.8511 - val_loss: 0.4020 - val_acc: 0.8710
Epoch 3/3
60000/60000 [==============================] - 9s 148us/step - loss: 0.3535 - acc: 0.8919 - val_loss: 0.3158 - val_acc: 0.9053
Test loss: 0.3157785811781883
Test accuracy: 0.9053
0 None
1 None
2 None
3 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 22s 359us/step - loss: 0.3804 - acc: 0.8922 - val_loss: 0.2151 - val_acc: 0.9344
Epoch 2/3
60000/60000 [==============================] - 18s 294us/step - loss: 0.1058 - acc: 0.9702 - val_loss: 0.0908 - val_acc: 0.9734
Epoch 3/3
60000/60000 [==============================] - 18s 295us/step - loss: 0.0692 - acc: 0.9796 - val_loss: 0.0785 - val_acc: 0.9771
Test loss: 0.07849819967597722
Test accuracy: 0.9771
0 None
1 None
2 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/3
60000/60000 [==============================] - 17s 286us/step - loss: 0.5713 - acc: 0.8397 - val_loss: 0.2013 - val_acc: 0.9450
Epoch 2/3
60000/60000 [==============================] - 13s 220us/step - loss: 0.1595 - acc: 0.9544 - val_loss: 0.1514 - val_acc: 0.9544
Epoch 3/3
60000/60000 [==============================] - 13s 221us/step - loss: 0.1030 - acc: 0.9701 - val_loss: 0.0935 - val_acc: 0.9735
Test loss: 0.09348477425612509
Test accuracy: 0.9735
  Evaluated 9 individuals
-- Generation 2 --
[<__main__.SerializedLayer object at 0x7f8b325cf128>, <__main__.SerializedLayer object at 0x7f8b325cf3c8>, <__main__.SerializedLayer object at 0x7f8b325c0be0>, <__main__.SerializedLayer object at 0x7f8b325c0a90>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1:Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 144, in remove_skip
    ind.remove_layer('Add')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Add layer is found.
 (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
1 3
0 2
[<__main__.SerializedLayer object at 0x7f8b325c0b00>, <__main__.SerializedLayer object at 0x7f8b325c0940>, <__main__.SerializedLayer object at 0x7f8b325c09b0>, <__main__.SerializedLayer object at 0x7f8b325c0668>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
1 3
0 1
[<__main__.SerializedLayer object at 0x7f8b325c04a8>, <__main__.SerializedLayer object at 0x7f8b3263de10>, <__main__.SerializedLayer object at 0x7f8b3263dba8>, <__main__.SerializedLayer object at 0x7f8b3263dac8>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
1 3
0 0
0 None
1 None
2 None
3 None
4 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/4
60000/60000 [==============================] - 27s 445us/step - loss: 0.3839 - acc: 0.8936 - val_loss: 0.1206 - val_acc: 0.9630
Epoch 2/4
60000/60000 [==============================] - 22s 371us/step - loss: 0.0887 - acc: 0.9736 - val_loss: 0.0958 - val_acc: 0.9700
Epoch 3/4
60000/60000 [==============================] - 22s 373us/step - loss: 0.0572 - acc: 0.9827 - val_loss: 0.0797 - val_acc: 0.9755
Epoch 4/4
60000/60000 [==============================] - 22s 372us/step - loss: 0.0437 - acc: 0.9867 - val_loss: 0.0639 - val_acc: 0.9800
Test loss: 0.06386043344400823
Test accuracy: 0.98
0 None
1 None
2 None
3 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/4
60000/60000 [==============================] - 22s 372us/step - loss: 0.5735 - acc: 0.8489 - val_loss: 0.2007 - val_acc: 0.9383
Epoch 2/4
60000/60000 [==============================] - 17s 291us/step - loss: 0.1424 - acc: 0.9600 - val_loss: 0.1110 - val_acc: 0.9651
Epoch 3/4
60000/60000 [==============================] - 18s 293us/step - loss: 0.0973 - acc: 0.9717 - val_loss: 0.0802 - val_acc: 0.9755
Epoch 4/4
60000/60000 [==============================] - 17s 291us/step - loss: 0.0749 - acc: 0.9781 - val_loss: 0.1111 - val_acc: 0.9633
Test loss: 0.11112689967751503
Test accuracy: 0.9633
0 None
1 None
2 None
3 None
4 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/4
60000/60000 [==============================] - 18s 297us/step - loss: 0.2481 - acc: 0.9415 - val_loss: 0.1363 - val_acc: 0.9588
Epoch 2/4
60000/60000 [==============================] - 13s 223us/step - loss: 0.0537 - acc: 0.9852 - val_loss: 0.0433 - val_acc: 0.9890
Epoch 3/4
60000/60000 [==============================] - 14s 226us/step - loss: 0.0359 - acc: 0.9898 - val_loss: 0.0523 - val_acc: 0.9841
Epoch 4/4
60000/60000 [==============================] - 14s 225us/step - loss: 0.0258 - acc: 0.9927 - val_loss: 0.0346 - val_acc: 0.9901
Test loss: 0.03462002633204684
Test accuracy: 0.9901
0 None
1 None
2 None
3 2
4 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/4
60000/60000 [==============================] - 24s 396us/step - loss: 0.4201 - acc: 0.8875 - val_loss: 0.1239 - val_acc: 0.9662
Epoch 2/4
60000/60000 [==============================] - 19s 314us/step - loss: 0.0948 - acc: 0.9731 - val_loss: 0.0970 - val_acc: 0.9732
Epoch 3/4
60000/60000 [==============================] - 20s 333us/step - loss: 0.0612 - acc: 0.9823 - val_loss: 0.0622 - val_acc: 0.9807
Epoch 4/4
60000/60000 [==============================] - 20s 333us/step - loss: 0.0469 - acc: 0.9858 - val_loss: 0.0828 - val_acc: 0.9743
Test loss: 0.08276826666798442
Test accuracy: 0.9743
0 None
1 None
2 None
3 1
4 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/4
60000/60000 [==============================] - 24s 401us/step - loss: 0.4726 - acc: 0.8704 - val_loss: 0.1515 - val_acc: 0.9590
Epoch 2/4
60000/60000 [==============================] - 19s 320us/step - loss: 0.1114 - acc: 0.9685 - val_loss: 0.0877 - val_acc: 0.9741
Epoch 3/4
60000/60000 [==============================] - 19s 314us/step - loss: 0.0706 - acc: 0.9793 - val_loss: 0.0730 - val_acc: 0.9796
Epoch 4/4
60000/60000 [==============================] - 19s 314us/step - loss: 0.0530 - acc: 0.9842 - val_loss: 0.0644 - val_acc: 0.9814
Test loss: 0.06435797749934719
Test accuracy: 0.9814
0 None
1 None
2 None
3 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/4
60000/60000 [==============================] - 23s 375us/step - loss: 0.4650 - acc: 0.8742 - val_loss: 0.1594 - val_acc: 0.9505
Epoch 2/4
60000/60000 [==============================] - 18s 292us/step - loss: 0.1171 - acc: 0.9650 - val_loss: 0.1046 - val_acc: 0.9688
Epoch 3/4
60000/60000 [==============================] - 18s 294us/step - loss: 0.0760 - acc: 0.9775 - val_loss: 0.0670 - val_acc: 0.9812
Epoch 4/4
60000/60000 [==============================] - 18s 297us/step - loss: 0.0585 - acc: 0.9827 - val_loss: 0.0613 - val_acc: 0.9824
Test loss: 0.061270715141668916
Test accuracy: 0.9824
0 None
1 None
2 None
3 0
4 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/4
60000/60000 [==============================] - 24s 396us/step - loss: 0.3464 - acc: 0.9058 - val_loss: 0.1331 - val_acc: 0.9622
Epoch 2/4
60000/60000 [==============================] - 18s 304us/step - loss: 0.0904 - acc: 0.9738 - val_loss: 0.0786 - val_acc: 0.9777
Epoch 3/4
60000/60000 [==============================] - 18s 303us/step - loss: 0.0606 - acc: 0.9827 - val_loss: 0.0557 - val_acc: 0.9838
Epoch 4/4
60000/60000 [==============================] - 18s 302us/step - loss: 0.0461 - acc: 0.9864 - val_loss: 0.0518 - val_acc: 0.9834
Test loss: 0.051759393146075305
Test accuracy: 0.9834
0 None
1 None
2 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/4
60000/60000 [==============================] - 19s 312us/step - loss: 0.7370 - acc: 0.7846 - val_loss: 0.3756 - val_acc: 0.8908
Epoch 2/4
60000/60000 [==============================] - 13s 224us/step - loss: 0.2480 - acc: 0.9278 - val_loss: 0.1995 - val_acc: 0.9410
Epoch 3/4
60000/60000 [==============================] - 14s 226us/step - loss: 0.1693 - acc: 0.9484 - val_loss: 0.1467 - val_acc: 0.9582
Epoch 4/4
60000/60000 [==============================] - 14s 225us/step - loss: 0.1337 - acc: 0.9593 - val_loss: 0.1217 - val_acc: 0.9644
Test loss: 0.12172805309593678
Test accuracy: 0.9644
0 None
1 None
2 None
3 None
4 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/4
60000/60000 [==============================] - 28s 473us/step - loss: 0.4822 - acc: 0.8651 - val_loss: 0.1513 - val_acc: 0.9542
Epoch 2/4
60000/60000 [==============================] - 22s 373us/step - loss: 0.0901 - acc: 0.9745 - val_loss: 0.0858 - val_acc: 0.9763
Epoch 3/4
60000/60000 [==============================] - 22s 375us/step - loss: 0.0568 - acc: 0.9830 - val_loss: 0.0556 - val_acc: 0.9808
Epoch 4/4
60000/60000 [==============================] - 22s 375us/step - loss: 0.0432 - acc: 0.9869 - val_loss: 0.0574 - val_acc: 0.9827
Test loss: 0.05736418373817578
Test accuracy: 0.9827
  Evaluated 9 individuals
-- Generation 3 --
[<__main__.SerializedLayer object at 0x7f8b2a5901d0>, <__main__.SerializedLayer object at 0x7f8b2a590470>, <__main__.SerializedLayer object at 0x7f8b2a590710>, <__main__.SerializedLayer object at 0x7f8b2a5909b0>, <__main__.SerializedLayer object at 0x7f8b2a590c50>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
1 3
0 2
0 None
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 169, in remove_fully_connected
    ind.remove_layer('Dense')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Dense layer is found.
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 124, in remove_dropout
    ind.remove_layer('Dropout')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Dropout layer is found.
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 144, in remove_skip
    ind.remove_layer('Add')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Add layer is found.
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 119, in add_dropout
    fc_layer = ind.sample_layer('Dense')
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Dense layer is found.
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 169, in remove_fully_connected
    ind.remove_layer('Dense')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Dense layer is found.
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 169, in remove_fully_connected
    ind.remove_layer('Dense')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Dense layer is found.
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 124, in remove_dropout
    ind.remove_layer('Dropout')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Dropout layer is found.
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 124, in remove_dropout
    ind.remove_layer('Dropout')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Dropout layer is found.
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 153, in remove_concatenate
    ind.remove_layer('Concatenate')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Concatenate layer is found.
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 144, in remove_skip
    ind.remove_layer('Add')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Add layer is found.
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 124, in remove_dropout
    ind.remove_layer('Dropout')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Dropout layer is found.
1 None
2 None
3 None
4 None
5 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/4
60000/60000 [==============================] - 21s 357us/step - loss: 0.2951 - acc: 0.9306 - val_loss: 0.1156 - val_acc: 0.9619
Epoch 2/4
60000/60000 [==============================] - 15s 254us/step - loss: 0.0491 - acc: 0.9857 - val_loss: 0.0444 - val_acc: 0.9852
Epoch 3/4
60000/60000 [==============================] - 15s 256us/step - loss: 0.0333 - acc: 0.9903 - val_loss: 0.0344 - val_acc: 0.9898
Epoch 4/4
60000/60000 [==============================] - 15s 254us/step - loss: 0.0250 - acc: 0.9928 - val_loss: 0.0299 - val_acc: 0.9896
Test loss: 0.029861014997691383
Test accuracy: 0.9896
0 None
1 None
2 None
3 2
0 None
1 None
2 None
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 7, in evalOneMax
    model = build_model(individual)
  File "/content/individual.py", line 85, in build_model
    outputs.append(l.evaluate([outputs[i - 1], outputs[l.bypass_index]]))
  File "/content/individual.py", line 21, in evaluate
    return func(prev_output)
  File "/usr/local/lib/python3.6/dist-packages/keras/engine/topology.py", line 594, in __call__
    self.build(input_shapes)
  File "/usr/local/lib/python3.6/dist-packages/keras/layers/merge.py", line 354, in build
    'Got inputs shapes: %s' % (input_shape))
ValueError: A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got inputs shapes: [(None, 14, 14, 32), (None, 28, 28, 32)]
3 None
4 None
5 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/4
60000/60000 [==============================] - 17s 276us/step - loss: 0.1920 - acc: 0.9539 - val_loss: 0.0818 - val_acc: 0.9754
Epoch 2/4
60000/60000 [==============================] - 10s 169us/step - loss: 0.0436 - acc: 0.9875 - val_loss: 0.0375 - val_acc: 0.9879
Epoch 3/4
60000/60000 [==============================] - 10s 167us/step - loss: 0.0286 - acc: 0.9920 - val_loss: 0.0349 - val_acc: 0.9888
Epoch 4/4
60000/60000 [==============================] - 10s 165us/step - loss: 0.0208 - acc: 0.9937 - val_loss: 0.0449 - val_acc: 0.9866
Test loss: 0.04485265963086858
Test accuracy: 0.9866
0 None
1 None
2 None
3 None
4 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/4
60000/60000 [==============================] - 20s 330us/step - loss: 0.3561 - acc: 0.9162 - val_loss: 0.1226 - val_acc: 0.9655
Epoch 2/4
60000/60000 [==============================] - 13s 221us/step - loss: 0.0699 - acc: 0.9818 - val_loss: 0.0529 - val_acc: 0.9837
Epoch 3/4
60000/60000 [==============================] - 13s 221us/step - loss: 0.0462 - acc: 0.9879 - val_loss: 0.0452 - val_acc: 0.9857
Epoch 4/4
60000/60000 [==============================] - 13s 220us/step - loss: 0.0331 - acc: 0.9913 - val_loss: 0.0398 - val_acc: 0.9875
Test loss: 0.03977328629214317
Test accuracy: 0.9875
0 None
1 None
2 None
3 None
4 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/4
60000/60000 [==============================] - 20s 341us/step - loss: 0.2672 - acc: 0.9374 - val_loss: 0.0911 - val_acc: 0.9749
Epoch 2/4
60000/60000 [==============================] - 14s 229us/step - loss: 0.0561 - acc: 0.9852 - val_loss: 0.0413 - val_acc: 0.9877
Epoch 3/4
60000/60000 [==============================] - 14s 231us/step - loss: 0.0371 - acc: 0.9904 - val_loss: 0.0451 - val_acc: 0.9863
Epoch 4/4
60000/60000 [==============================] - 14s 230us/step - loss: 0.0261 - acc: 0.9928 - val_loss: 0.0376 - val_acc: 0.9879
Test loss: 0.03764713953440078
Test accuracy: 0.9879
0 None
1 None
2 None
3 None
4 None
5 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/4
60000/60000 [==============================] - 23s 376us/step - loss: 0.3074 - acc: 0.9301 - val_loss: 0.0816 - val_acc: 0.9753
Epoch 2/4
60000/60000 [==============================] - 15s 255us/step - loss: 0.0521 - acc: 0.9859 - val_loss: 0.1178 - val_acc: 0.9630
Epoch 3/4
60000/60000 [==============================] - 15s 255us/step - loss: 0.0348 - acc: 0.9899 - val_loss: 0.0336 - val_acc: 0.9900
Epoch 4/4
60000/60000 [==============================] - 15s 255us/step - loss: 0.0244 - acc: 0.9928 - val_loss: 0.0343 - val_acc: 0.9889
Test loss: 0.03426614791615866
Test accuracy: 0.9889
0 None
1 None
2 None
3 None
4 None
5 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/4
60000/60000 [==============================] - 23s 379us/step - loss: 0.1995 - acc: 0.9486 - val_loss: 0.0842 - val_acc: 0.9745
Epoch 2/4
60000/60000 [==============================] - 15s 258us/step - loss: 0.0457 - acc: 0.9872 - val_loss: 0.0545 - val_acc: 0.9836
Epoch 3/4
60000/60000 [==============================] - 15s 254us/step - loss: 0.0312 - acc: 0.9908 - val_loss: 0.0282 - val_acc: 0.9912
Epoch 4/4
60000/60000 [==============================] - 15s 255us/step - loss: 0.0226 - acc: 0.9935 - val_loss: 0.0371 - val_acc: 0.9891
Test loss: 0.037095993703976274
Test accuracy: 0.9891
0 None
1 None
2 None
3 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/4
60000/60000 [==============================] - 18s 293us/step - loss: 0.6290 - acc: 0.8302 - val_loss: 0.2090 - val_acc: 0.9481
Epoch 2/4
60000/60000 [==============================] - 11s 177us/step - loss: 0.1479 - acc: 0.9610 - val_loss: 0.1209 - val_acc: 0.9682
Epoch 3/4
60000/60000 [==============================] - 11s 177us/step - loss: 0.0973 - acc: 0.9724 - val_loss: 0.1013 - val_acc: 0.9695
Epoch 4/4
60000/60000 [==============================] - 11s 177us/step - loss: 0.0753 - acc: 0.9784 - val_loss: 0.0763 - val_acc: 0.9788
Test loss: 0.0762910822186619
Test accuracy: 0.9788
0 None
1 None
2 None
3 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/4
60000/60000 [==============================] - 17s 279us/step - loss: 0.3519 - acc: 0.9202 - val_loss: 0.1238 - val_acc: 0.9631
Epoch 2/4
60000/60000 [==============================] - 9s 157us/step - loss: 0.0631 - acc: 0.9835 - val_loss: 0.0497 - val_acc: 0.9855
Epoch 3/4
60000/60000 [==============================] - 9s 155us/step - loss: 0.0397 - acc: 0.9892 - val_loss: 0.0667 - val_acc: 0.9792
Epoch 4/4
60000/60000 [==============================] - 9s 153us/step - loss: 0.0283 - acc: 0.9923 - val_loss: 0.0349 - val_acc: 0.9891
Test loss: 0.03493445068607107
Test accuracy: 0.9891
  Evaluated 9 individuals
-- Generation 4 --
[<__main__.SerializedLayer object at 0x7f8b2fa230f0>, <__main__.SerializedLayer object at 0x7f8b2fa25160>, <__main__.SerializedLayer object at 0x7f8b2fa25438>, <__main__.SerializedLayer object at 0x7f8b2fa25710>, <__main__.SerializedLayer object at 0x7f8b2fa259e8>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
1 4
0 2
0 None
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 153, in remove_concatenate
    ind.remove_layer('Concatenate')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Concatenate layer is found.
1 None
2 None
3 None
4 None
5 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/5
60000/60000 [==============================] - 19s 318us/step - loss: 0.1715 - acc: 0.9584 - val_loss: 0.0666 - val_acc: 0.9810
Epoch 2/5
60000/60000 [==============================] - 11s 190us/step - loss: 0.0419 - acc: 0.9884 - val_loss: 0.0327 - val_acc: 0.9895
Epoch 3/5
60000/60000 [==============================] - 11s 190us/step - loss: 0.0279 - acc: 0.9923 - val_loss: 0.0318 - val_acc: 0.9894
Epoch 4/5
60000/60000 [==============================] - 11s 188us/step - loss: 0.0199 - acc: 0.9945 - val_loss: 0.0478 - val_acc: 0.9848
Epoch 5/5
60000/60000 [==============================] - 11s 190us/step - loss: 0.0155 - acc: 0.9959 - val_loss: 0.0513 - val_acc: 0.9839
Test loss: 0.051254679559287614
Test accuracy: 0.9839
0 None
1 None
2 None
3 None
4 2
0 None
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 7, in evalOneMax
    model = build_model(individual)
  File "/content/individual.py", line 85, in build_model
    outputs.append(l.evaluate([outputs[i - 1], outputs[l.bypass_index]]))
  File "/content/individual.py", line 21, in evaluate
    return func(prev_output)
  File "/usr/local/lib/python3.6/dist-packages/keras/engine/topology.py", line 594, in __call__
    self.build(input_shapes)
  File "/usr/local/lib/python3.6/dist-packages/keras/layers/merge.py", line 354, in build
    'Got inputs shapes: %s' % (input_shape))
ValueError: A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got inputs shapes: [(None, 14, 14, 32), (None, 28, 28, 32)]
1 None
2 None
3 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/5
60000/60000 [==============================] - 17s 286us/step - loss: 0.3057 - acc: 0.9279 - val_loss: 0.0979 - val_acc: 0.9719
Epoch 2/5
60000/60000 [==============================] - 9s 157us/step - loss: 0.0610 - acc: 0.9836 - val_loss: 0.0570 - val_acc: 0.9841
Epoch 3/5
60000/60000 [==============================] - 9s 155us/step - loss: 0.0408 - acc: 0.9888 - val_loss: 0.0400 - val_acc: 0.9871
Epoch 4/5
60000/60000 [==============================] - 9s 154us/step - loss: 0.0308 - acc: 0.9913 - val_loss: 0.0327 - val_acc: 0.9892
Epoch 5/5
60000/60000 [==============================] - 9s 154us/step - loss: 0.0238 - acc: 0.9934 - val_loss: 0.0450 - val_acc: 0.9857
Test loss: 0.04495062237973325
Test accuracy: 0.9857
0 None
1 None
2 None
3 None
4 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/5
60000/60000 [==============================] - 19s 311us/step - loss: 0.2144 - acc: 0.9494 - val_loss: 0.0721 - val_acc: 0.9773
Epoch 2/5
60000/60000 [==============================] - 11s 179us/step - loss: 0.0465 - acc: 0.9874 - val_loss: 0.0569 - val_acc: 0.9826
Epoch 3/5
60000/60000 [==============================] - 11s 182us/step - loss: 0.0315 - acc: 0.9908 - val_loss: 0.0546 - val_acc: 0.9816
Epoch 4/5
60000/60000 [==============================] - 11s 183us/step - loss: 0.0219 - acc: 0.9942 - val_loss: 0.0362 - val_acc: 0.9886
Epoch 5/5
60000/60000 [==============================] - 11s 179us/step - loss: 0.0168 - acc: 0.9955 - val_loss: 0.0379 - val_acc: 0.9880
Test loss: 0.03787216941164807
Test accuracy: 0.988
0 None
1 None
2 None
3 None
4 None
5 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/5
60000/60000 [==============================] - 27s 445us/step - loss: 0.2248 - acc: 0.9437 - val_loss: 0.1104 - val_acc: 0.9666
Epoch 2/5
60000/60000 [==============================] - 18s 306us/step - loss: 0.0479 - acc: 0.9869 - val_loss: 0.0467 - val_acc: 0.9861
Epoch 3/5
60000/60000 [==============================] - 18s 305us/step - loss: 0.0303 - acc: 0.9921 - val_loss: 0.0345 - val_acc: 0.9888
Epoch 4/5
60000/60000 [==============================] - 18s 306us/step - loss: 0.0230 - acc: 0.9936 - val_loss: 0.0332 - val_acc: 0.9898
Epoch 5/5
60000/60000 [==============================] - 18s 306us/step - loss: 0.0174 - acc: 0.9955 - val_loss: 0.0258 - val_acc: 0.9923
Test loss: 0.025804130563512443
Test accuracy: 0.9923
0 None
1 None
2 None
3 None
4 None
5 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/5
60000/60000 [==============================] - 20s 330us/step - loss: 0.2047 - acc: 0.9517 - val_loss: 0.1024 - val_acc: 0.9713
Epoch 2/5
60000/60000 [==============================] - 11s 191us/step - loss: 0.0412 - acc: 0.9885 - val_loss: 0.0505 - val_acc: 0.9855
Epoch 3/5
60000/60000 [==============================] - 11s 190us/step - loss: 0.0271 - acc: 0.9926 - val_loss: 0.0731 - val_acc: 0.9785
Epoch 4/5
60000/60000 [==============================] - 11s 188us/step - loss: 0.0211 - acc: 0.9941 - val_loss: 0.0269 - val_acc: 0.9904
Epoch 5/5
60000/60000 [==============================] - 11s 189us/step - loss: 0.0154 - acc: 0.9957 - val_loss: 0.0234 - val_acc: 0.9927
Test loss: 0.023443721922743133
Test accuracy: 0.9927
0 None
1 None
2 None
3 None
4 None
5 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/5
60000/60000 [==============================] - 25s 412us/step - loss: 0.2282 - acc: 0.9409 - val_loss: 0.0705 - val_acc: 0.9814
Epoch 2/5
60000/60000 [==============================] - 16s 271us/step - loss: 0.0436 - acc: 0.9873 - val_loss: 0.0322 - val_acc: 0.9899
Epoch 3/5
60000/60000 [==============================] - 16s 271us/step - loss: 0.0297 - acc: 0.9910 - val_loss: 0.0530 - val_acc: 0.9827
Epoch 4/5
60000/60000 [==============================] - 16s 271us/step - loss: 0.0220 - acc: 0.9935 - val_loss: 0.0242 - val_acc: 0.9925
Epoch 5/5
60000/60000 [==============================] - 16s 271us/step - loss: 0.0182 - acc: 0.9943 - val_loss: 0.0193 - val_acc: 0.9941
Test loss: 0.019329261579032756
Test accuracy: 0.9941
0 None
1 None
2 None
3 None
4 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/5
60000/60000 [==============================] - 20s 328us/step - loss: 0.2213 - acc: 0.9474 - val_loss: 0.0494 - val_acc: 0.9857
Epoch 2/5
60000/60000 [==============================] - 11s 187us/step - loss: 0.0452 - acc: 0.9874 - val_loss: 0.0728 - val_acc: 0.9757
Epoch 3/5
60000/60000 [==============================] - 11s 182us/step - loss: 0.0297 - acc: 0.9915 - val_loss: 0.0313 - val_acc: 0.9905
Epoch 4/5
60000/60000 [==============================] - 11s 181us/step - loss: 0.0214 - acc: 0.9942 - val_loss: 0.0412 - val_acc: 0.9862
Epoch 5/5
60000/60000 [==============================] - 11s 180us/step - loss: 0.0164 - acc: 0.9956 - val_loss: 0.0281 - val_acc: 0.9910
Test loss: 0.028058285077894107
Test accuracy: 0.991
0 None
1 None
2 None
3 None
4 None
5 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/5
60000/60000 [==============================] - 28s 460us/step - loss: 0.2835 - acc: 0.9318 - val_loss: 0.0695 - val_acc: 0.9802
Epoch 2/5
60000/60000 [==============================] - 19s 308us/step - loss: 0.0520 - acc: 0.9861 - val_loss: 0.1380 - val_acc: 0.9557
Epoch 3/5
60000/60000 [==============================] - 18s 308us/step - loss: 0.0340 - acc: 0.9907 - val_loss: 0.0436 - val_acc: 0.9869
Epoch 4/5
60000/60000 [==============================] - 18s 306us/step - loss: 0.0263 - acc: 0.9929 - val_loss: 0.0367 - val_acc: 0.9890
Epoch 5/5
60000/60000 [==============================] - 18s 306us/step - loss: 0.0202 - acc: 0.9944 - val_loss: 0.0325 - val_acc: 0.9900
Test loss: 0.03245416501435684
Test accuracy: 0.99
  Evaluated 9 individuals
-- Generation 5 --
[<__main__.SerializedLayer object at 0x7f8b1b8cd518>, <__main__.SerializedLayer object at 0x7f8b1b8cd7b8>, <__main__.SerializedLayer object at 0x7f8b1b8cda58>, <__main__.SerializedLayer object at 0x7f8b1b8cdcf8>, <__main__.SerializedLayer object at 0x7f8b1b8cdf98>, <__main__.SerializedLayer object at 0x7f8b1b8cc278>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 150)
False
1 4
0 2
[<__main__.SerializedLayer object at 0x7f8b1b8d5668>, <__main__.SerializedLayer object at 0x7f8b1b8d5908>, <__main__.SerializedLayer object at 0x7f8b1b8d5ba8>, <__main__.SerializedLayer object at 0x7f8b1b8d5e48>, <__main__.SerializedLayer object at 0x7f8b1b8d9128>, <__main__.SerializedLayer object at 0x7f8b1b8d93c8>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 150)
False
1 4
0 2
0 None
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 124, in remove_dropout
    ind.remove_layer('Dropout')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Dropout layer is found.
1 None
2 None
3 None
4 None
5 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/6
60000/60000 [==============================] - 24s 405us/step - loss: 0.3705 - acc: 0.8982 - val_loss: 0.0904 - val_acc: 0.9731
Epoch 2/6
60000/60000 [==============================] - 15s 251us/step - loss: 0.0713 - acc: 0.9787 - val_loss: 0.0567 - val_acc: 0.9828
Epoch 3/6
60000/60000 [==============================] - 15s 251us/step - loss: 0.0469 - acc: 0.9858 - val_loss: 0.0611 - val_acc: 0.9809
Epoch 4/6
60000/60000 [==============================] - 15s 250us/step - loss: 0.0358 - acc: 0.9893 - val_loss: 0.0687 - val_acc: 0.9760
Epoch 5/6
60000/60000 [==============================] - 15s 250us/step - loss: 0.0297 - acc: 0.9908 - val_loss: 0.0347 - val_acc: 0.9890
Epoch 6/6
60000/60000 [==============================] - 15s 248us/step - loss: 0.0233 - acc: 0.9929 - val_loss: 0.1045 - val_acc: 0.9643
Test loss: 0.1044737371656578
Test accuracy: 0.9643
0 None
1 None
2 None
3 None
4 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/6
60000/60000 [==============================] - 20s 326us/step - loss: 0.2454 - acc: 0.9376 - val_loss: 0.0816 - val_acc: 0.9750
Epoch 2/6
60000/60000 [==============================] - 11s 178us/step - loss: 0.0524 - acc: 0.9853 - val_loss: 0.0389 - val_acc: 0.9879
Epoch 3/6
60000/60000 [==============================] - 11s 178us/step - loss: 0.0345 - acc: 0.9897 - val_loss: 0.0320 - val_acc: 0.9893
Epoch 4/6
60000/60000 [==============================] - 11s 180us/step - loss: 0.0260 - acc: 0.9922 - val_loss: 0.0576 - val_acc: 0.9798
Epoch 5/6
60000/60000 [==============================] - 11s 182us/step - loss: 0.0198 - acc: 0.9942 - val_loss: 0.0577 - val_acc: 0.9816
Epoch 6/6
60000/60000 [==============================] - 11s 179us/step - loss: 0.0160 - acc: 0.9951 - val_loss: 0.0416 - val_acc: 0.9865
Test loss: 0.04158896795457695
Test accuracy: 0.9865
0 None
1 None
2 None
3 None
4 None
5 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/6
60000/60000 [==============================] - 20s 335us/step - loss: 0.1949 - acc: 0.9509 - val_loss: 0.0617 - val_acc: 0.9803
Epoch 2/6
60000/60000 [==============================] - 11s 181us/step - loss: 0.0441 - acc: 0.9864 - val_loss: 0.0543 - val_acc: 0.9825
Epoch 3/6
60000/60000 [==============================] - 11s 186us/step - loss: 0.0302 - acc: 0.9905 - val_loss: 0.0522 - val_acc: 0.9839
Epoch 4/6
60000/60000 [==============================] - 11s 186us/step - loss: 0.0215 - acc: 0.9935 - val_loss: 0.0285 - val_acc: 0.9911
Epoch 5/6
60000/60000 [==============================] - 11s 182us/step - loss: 0.0166 - acc: 0.9949 - val_loss: 0.0245 - val_acc: 0.9928
Epoch 6/6
60000/60000 [==============================] - 11s 187us/step - loss: 0.0124 - acc: 0.9961 - val_loss: 0.0296 - val_acc: 0.9902
Test loss: 0.02960771122970036
Test accuracy: 0.9902
0 None
1 None
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/6
60000/60000 [==============================] - 31s 517us/step - loss: 0.2072 - acc: 0.9462 - val_loss: 0.4537 - val_acc: 0.8565
Epoch 2/6
60000/60000 [==============================] - 22s 372us/step - loss: 0.0412 - acc: 0.9876 - val_loss: 0.0341 - val_acc: 0.9893
Epoch 3/6
60000/60000 [==============================] - 21s 349us/step - loss: 0.0281 - acc: 0.9916 - val_loss: 0.0347 - val_acc: 0.9892
Epoch 4/6
60000/60000 [==============================] - 21s 343us/step - loss: 0.0226 - acc: 0.9928 - val_loss: 0.0288 - val_acc: 0.9916
Epoch 5/6
60000/60000 [==============================] - 21s 345us/step - loss: 0.0172 - acc: 0.9949 - val_loss: 0.0286 - val_acc: 0.9915
Epoch 6/6
60000/60000 [==============================] - 20s 341us/step - loss: 0.0139 - acc: 0.9957 - val_loss: 0.0252 - val_acc: 0.9928
Test loss: 0.025237653864212915
Test accuracy: 0.9928
0 None
1 None
2 None
3 None
4 2
0 None
1 None
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 7, in evalOneMax
    model = build_model(individual)
  File "/content/individual.py", line 85, in build_model
    outputs.append(l.evaluate([outputs[i - 1], outputs[l.bypass_index]]))
  File "/content/individual.py", line 21, in evaluate
    return func(prev_output)
  File "/usr/local/lib/python3.6/dist-packages/keras/engine/topology.py", line 594, in __call__
    self.build(input_shapes)
  File "/usr/local/lib/python3.6/dist-packages/keras/layers/merge.py", line 354, in build
    'Got inputs shapes: %s' % (input_shape))
ValueError: A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got inputs shapes: [(None, 14, 14, 32), (None, 28, 28, 32)]
2 None
3 None
4 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/6
60000/60000 [==============================] - 36s 592us/step - loss: 0.3646 - acc: 0.8961 - val_loss: 0.0780 - val_acc: 0.9785
Epoch 2/6
60000/60000 [==============================] - 26s 425us/step - loss: 0.0734 - acc: 0.9784 - val_loss: 0.0589 - val_acc: 0.9806
Epoch 3/6
60000/60000 [==============================] - 26s 434us/step - loss: 0.0509 - acc: 0.9842 - val_loss: 0.0487 - val_acc: 0.9842
Epoch 4/6
60000/60000 [==============================] - 26s 432us/step - loss: 0.0399 - acc: 0.9880 - val_loss: 0.0413 - val_acc: 0.9866
Epoch 5/6
60000/60000 [==============================] - 26s 434us/step - loss: 0.0316 - acc: 0.9905 - val_loss: 0.0529 - val_acc: 0.9827
Epoch 6/6
60000/60000 [==============================] - 26s 433us/step - loss: 0.0276 - acc: 0.9910 - val_loss: 0.0401 - val_acc: 0.9869
Test loss: 0.040081022854274485
Test accuracy: 0.9869
0 None
1 None
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/6
60000/60000 [==============================] - 29s 480us/step - loss: 0.2201 - acc: 0.9375 - val_loss: 0.0684 - val_acc: 0.9786
Epoch 2/6
60000/60000 [==============================] - 18s 307us/step - loss: 0.0447 - acc: 0.9860 - val_loss: 0.0548 - val_acc: 0.9836
Epoch 3/6
60000/60000 [==============================] - 18s 305us/step - loss: 0.0321 - acc: 0.9901 - val_loss: 0.0416 - val_acc: 0.9874
Epoch 4/6
60000/60000 [==============================] - 18s 307us/step - loss: 0.0240 - acc: 0.9926 - val_loss: 0.0249 - val_acc: 0.9918
Epoch 5/6
60000/60000 [==============================] - 18s 306us/step - loss: 0.0200 - acc: 0.9937 - val_loss: 0.0232 - val_acc: 0.9929
Epoch 6/6
60000/60000 [==============================] - 18s 305us/step - loss: 0.0172 - acc: 0.9946 - val_loss: 0.0255 - val_acc: 0.9916
Test loss: 0.025547973557635124
Test accuracy: 0.9916
0 None
1 None
2 None
3 None
4 2
0 None
1 None
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 7, in evalOneMax
    model = build_model(individual)
  File "/content/individual.py", line 85, in build_model
    outputs.append(l.evaluate([outputs[i - 1], outputs[l.bypass_index]]))
  File "/content/individual.py", line 21, in evaluate
    return func(prev_output)
  File "/usr/local/lib/python3.6/dist-packages/keras/engine/topology.py", line 594, in __call__
    self.build(input_shapes)
  File "/usr/local/lib/python3.6/dist-packages/keras/layers/merge.py", line 90, in build
    output_shape = self._compute_elemwise_op_output_shape(output_shape, shape)
  File "/usr/local/lib/python3.6/dist-packages/keras/layers/merge.py", line 61, in _compute_elemwise_op_output_shape
    str(shape1) + ' ' + str(shape2))
ValueError: Operands could not be broadcast together with shapes (14, 14, 32) (28, 28, 32)
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/6
60000/60000 [==============================] - 26s 425us/step - loss: 0.2438 - acc: 0.9371 - val_loss: 0.0709 - val_acc: 0.9777
Epoch 2/6
60000/60000 [==============================] - 15s 245us/step - loss: 0.0486 - acc: 0.9858 - val_loss: 0.0356 - val_acc: 0.9882
Epoch 3/6
60000/60000 [==============================] - 15s 245us/step - loss: 0.0327 - acc: 0.9901 - val_loss: 0.0460 - val_acc: 0.9850
Epoch 4/6
60000/60000 [==============================] - 15s 247us/step - loss: 0.0253 - acc: 0.9923 - val_loss: 0.0278 - val_acc: 0.9913
Epoch 5/6
60000/60000 [==============================] - 15s 258us/step - loss: 0.0197 - acc: 0.9940 - val_loss: 0.0324 - val_acc: 0.9890
Epoch 6/6
60000/60000 [==============================] - 15s 248us/step - loss: 0.0162 - acc: 0.9949 - val_loss: 0.0297 - val_acc: 0.9900
Test loss: 0.02966665778285824
Test accuracy: 0.99
  Evaluated 9 individuals
-- Generation 6 --
[<__main__.SerializedLayer object at 0x7f8b149424e0>, <__main__.SerializedLayer object at 0x7f8b14942390>, <__main__.SerializedLayer object at 0x7f8b14942160>, <__main__.SerializedLayer object at 0x7f8b149420b8>, <__main__.SerializedLayer object at 0x7f8b14942ef0>, <__main__.SerializedLayer object at 0x7f8b14940da0>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 150)
False
1 4
0 3
0 None
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 153, in remove_concatenate
    ind.remove_layer('Concatenate')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Concatenate layer is found.
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 144, in remove_skip
    ind.remove_layer('Add')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Add layer is found.
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 144, in remove_skip
    ind.remove_layer('Add')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Add layer is found.
1 None
2 None
3 None
4 None
5 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/6
60000/60000 [==============================] - 27s 442us/step - loss: 0.2537 - acc: 0.9313 - val_loss: 0.0694 - val_acc: 0.9784
Epoch 2/6
60000/60000 [==============================] - 16s 265us/step - loss: 0.0560 - acc: 0.9834 - val_loss: 0.0536 - val_acc: 0.9832
Epoch 3/6
60000/60000 [==============================] - 16s 267us/step - loss: 0.0376 - acc: 0.9886 - val_loss: 0.0397 - val_acc: 0.9859
Epoch 4/6
60000/60000 [==============================] - 16s 267us/step - loss: 0.0280 - acc: 0.9915 - val_loss: 0.0309 - val_acc: 0.9902
Epoch 5/6
60000/60000 [==============================] - 16s 267us/step - loss: 0.0222 - acc: 0.9934 - val_loss: 0.0312 - val_acc: 0.9895
Epoch 6/6
60000/60000 [==============================] - 16s 267us/step - loss: 0.0172 - acc: 0.9951 - val_loss: 0.0270 - val_acc: 0.9912
Test loss: 0.027034971306452642
Test accuracy: 0.9912
0 None
1 None
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/6
60000/60000 [==============================] - 31s 522us/step - loss: 0.1971 - acc: 0.9435 - val_loss: 0.0580 - val_acc: 0.9811
Epoch 2/6
60000/60000 [==============================] - 20s 340us/step - loss: 0.0441 - acc: 0.9864 - val_loss: 0.0454 - val_acc: 0.9865
Epoch 3/6
60000/60000 [==============================] - 20s 340us/step - loss: 0.0320 - acc: 0.9899 - val_loss: 0.0379 - val_acc: 0.9881
Epoch 4/6
60000/60000 [==============================] - 20s 340us/step - loss: 0.0257 - acc: 0.9919 - val_loss: 0.1260 - val_acc: 0.9587
Epoch 5/6
60000/60000 [==============================] - 21s 342us/step - loss: 0.0211 - acc: 0.9930 - val_loss: 0.0316 - val_acc: 0.9910
Epoch 6/6
60000/60000 [==============================] - 20s 339us/step - loss: 0.0177 - acc: 0.9942 - val_loss: 0.0197 - val_acc: 0.9939
Test loss: 0.01973862852240127
Test accuracy: 0.9939
0 None
1 None
2 None
3 None
4 3
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/6
60000/60000 [==============================] - 29s 475us/step - loss: 0.2328 - acc: 0.9412 - val_loss: 0.0449 - val_acc: 0.9852
Epoch 2/6
60000/60000 [==============================] - 17s 291us/step - loss: 0.0431 - acc: 0.9878 - val_loss: 0.0377 - val_acc: 0.9882
Epoch 3/6
60000/60000 [==============================] - 17s 290us/step - loss: 0.0293 - acc: 0.9913 - val_loss: 0.0323 - val_acc: 0.9895
Epoch 4/6
60000/60000 [==============================] - 17s 289us/step - loss: 0.0215 - acc: 0.9934 - val_loss: 0.0239 - val_acc: 0.9919
Epoch 5/6
60000/60000 [==============================] - 18s 292us/step - loss: 0.0164 - acc: 0.9954 - val_loss: 0.0478 - val_acc: 0.9836
Epoch 6/6
60000/60000 [==============================] - 17s 291us/step - loss: 0.0121 - acc: 0.9965 - val_loss: 0.0204 - val_acc: 0.9930
Test loss: 0.020399776548799126
Test accuracy: 0.993
0 None
1 None
2 None
3 None
4 None
5 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/6
60000/60000 [==============================] - 22s 366us/step - loss: 0.2016 - acc: 0.9483 - val_loss: 0.0526 - val_acc: 0.9834
Epoch 2/6
60000/60000 [==============================] - 11s 178us/step - loss: 0.0423 - acc: 0.9874 - val_loss: 0.1165 - val_acc: 0.9602
Epoch 3/6
60000/60000 [==============================] - 11s 179us/step - loss: 0.0269 - acc: 0.9920 - val_loss: 0.0400 - val_acc: 0.9868
Epoch 4/6
60000/60000 [==============================] - 11s 179us/step - loss: 0.0188 - acc: 0.9946 - val_loss: 0.0338 - val_acc: 0.9886
Epoch 5/6
60000/60000 [==============================] - 11s 180us/step - loss: 0.0147 - acc: 0.9955 - val_loss: 0.0296 - val_acc: 0.9896
Epoch 6/6
60000/60000 [==============================] - 11s 178us/step - loss: 0.0110 - acc: 0.9966 - val_loss: 0.0319 - val_acc: 0.9898
Test loss: 0.03194520241869686
Test accuracy: 0.9898
0 None
1 None
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/6
60000/60000 [==============================] - 28s 473us/step - loss: 0.4254 - acc: 0.8782 - val_loss: 0.0776 - val_acc: 0.9821
Epoch 2/6
60000/60000 [==============================] - 17s 275us/step - loss: 0.0835 - acc: 0.9743 - val_loss: 0.1151 - val_acc: 0.9684
Epoch 3/6
60000/60000 [==============================] - 17s 275us/step - loss: 0.0577 - acc: 0.9824 - val_loss: 0.0842 - val_acc: 0.9767
Epoch 4/6
60000/60000 [==============================] - 16s 275us/step - loss: 0.0474 - acc: 0.9853 - val_loss: 0.1016 - val_acc: 0.9698
Epoch 5/6
60000/60000 [==============================] - 17s 275us/step - loss: 0.0398 - acc: 0.9873 - val_loss: 0.0708 - val_acc: 0.9814
Epoch 6/6
60000/60000 [==============================] - 16s 274us/step - loss: 0.0360 - acc: 0.9886 - val_loss: 0.0345 - val_acc: 0.9906
Test loss: 0.03449664539545774
Test accuracy: 0.9906
0 None
1 None
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/6
60000/60000 [==============================] - 31s 513us/step - loss: 0.1902 - acc: 0.9505 - val_loss: 0.0495 - val_acc: 0.9847
Epoch 2/6
60000/60000 [==============================] - 18s 305us/step - loss: 0.0419 - acc: 0.9878 - val_loss: 0.0759 - val_acc: 0.9738
Epoch 3/6
60000/60000 [==============================] - 18s 304us/step - loss: 0.0278 - acc: 0.9922 - val_loss: 0.0249 - val_acc: 0.9910
Epoch 4/6
60000/60000 [==============================] - 18s 302us/step - loss: 0.0220 - acc: 0.9935 - val_loss: 0.0362 - val_acc: 0.9886
Epoch 5/6
60000/60000 [==============================] - 18s 304us/step - loss: 0.0176 - acc: 0.9945 - val_loss: 0.0205 - val_acc: 0.9932
Epoch 6/6
60000/60000 [==============================] - 18s 304us/step - loss: 0.0131 - acc: 0.9962 - val_loss: 0.0235 - val_acc: 0.9923
Test loss: 0.02345422714275337
Test accuracy: 0.9923
0 None
1 None
2 None
3 None
4 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/6
60000/60000 [==============================] - 27s 444us/step - loss: 0.2936 - acc: 0.9304 - val_loss: 0.0891 - val_acc: 0.9758
Epoch 2/6
60000/60000 [==============================] - 14s 233us/step - loss: 0.0573 - acc: 0.9847 - val_loss: 0.0583 - val_acc: 0.9819
Epoch 3/6
60000/60000 [==============================] - 14s 235us/step - loss: 0.0367 - acc: 0.9900 - val_loss: 0.0372 - val_acc: 0.9896
Epoch 4/6
60000/60000 [==============================] - 14s 234us/step - loss: 0.0275 - acc: 0.9917 - val_loss: 0.0333 - val_acc: 0.9886
Epoch 5/6
60000/60000 [==============================] - 14s 235us/step - loss: 0.0212 - acc: 0.9939 - val_loss: 0.0296 - val_acc: 0.9901
Epoch 6/6
60000/60000 [==============================] - 14s 235us/step - loss: 0.0168 - acc: 0.9953 - val_loss: 0.0227 - val_acc: 0.9928
Test loss: 0.022715353705128654
Test accuracy: 0.9928
0 None
1 None
2 None
3 None
4 None
5 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/6
60000/60000 [==============================] - 27s 447us/step - loss: 0.2611 - acc: 0.9328 - val_loss: 0.0647 - val_acc: 0.9796
Epoch 2/6
60000/60000 [==============================] - 14s 233us/step - loss: 0.0501 - acc: 0.9850 - val_loss: 0.0389 - val_acc: 0.9863
Epoch 3/6
60000/60000 [==============================] - 14s 233us/step - loss: 0.0341 - acc: 0.9894 - val_loss: 0.0354 - val_acc: 0.9887
Epoch 4/6
60000/60000 [==============================] - 14s 230us/step - loss: 0.0261 - acc: 0.9923 - val_loss: 0.0323 - val_acc: 0.9891
Epoch 5/6
60000/60000 [==============================] - 14s 231us/step - loss: 0.0212 - acc: 0.9936 - val_loss: 0.0335 - val_acc: 0.9885
Epoch 6/6
60000/60000 [==============================] - 14s 232us/step - loss: 0.0160 - acc: 0.9952 - val_loss: 0.0408 - val_acc: 0.9873
Test loss: 0.040849991453380786
Test accuracy: 0.9873
0 None
1 None
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/6
60000/60000 [==============================] - 29s 490us/step - loss: 0.3712 - acc: 0.8911 - val_loss: 0.1257 - val_acc: 0.9669
Epoch 2/6
60000/60000 [==============================] - 17s 277us/step - loss: 0.0799 - acc: 0.9753 - val_loss: 0.0793 - val_acc: 0.9823
Epoch 3/6
60000/60000 [==============================] - 17s 278us/step - loss: 0.0567 - acc: 0.9827 - val_loss: 0.0815 - val_acc: 0.9799
Epoch 4/6
60000/60000 [==============================] - 17s 276us/step - loss: 0.0443 - acc: 0.9864 - val_loss: 0.0418 - val_acc: 0.9894
Epoch 5/6
60000/60000 [==============================] - 17s 276us/step - loss: 0.0391 - acc: 0.9879 - val_loss: 0.0771 - val_acc: 0.9787
Epoch 6/6
60000/60000 [==============================] - 17s 277us/step - loss: 0.0342 - acc: 0.9893 - val_loss: 0.0293 - val_acc: 0.9934
Test loss: 0.029342296496406198
Test accuracy: 0.9934
  Evaluated 9 individuals
-- Generation 7 --
[<__main__.SerializedLayer object at 0x7f8b0bed9e10>, <__main__.SerializedLayer object at 0x7f8b0bee10f0>, <__main__.SerializedLayer object at 0x7f8b0bee1390>, <__main__.SerializedLayer object at 0x7f8b0bee1630>, <__main__.SerializedLayer object at 0x7f8b0bee18d0>, <__main__.SerializedLayer object at 0x7f8b0bee1b70>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 150)
False
1 4
0 2
0 None
1 None
2 None
3 None
4 None
5 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/7
60000/60000 [==============================] - 29s 488us/step - loss: 0.2228 - acc: 0.9449 - val_loss: 0.0493 - val_acc: 0.9859
Epoch 2/7
60000/60000 [==============================] - 16s 274us/step - loss: 0.0446 - acc: 0.9871 - val_loss: 0.1009 - val_acc: 0.9663
Epoch 3/7
60000/60000 [==============================] - 17s 276us/step - loss: 0.0304 - acc: 0.9907 - val_loss: 0.0471 - val_acc: 0.9863
Epoch 4/7
60000/60000 [==============================] - 16s 274us/step - loss: 0.0231 - acc: 0.9929 - val_loss: 0.0297 - val_acc: 0.9911
Epoch 5/7
60000/60000 [==============================] - 16s 274us/step - loss: 0.0179 - acc: 0.9946 - val_loss: 0.0183 - val_acc: 0.9939
Epoch 6/7
60000/60000 [==============================] - 16s 274us/step - loss: 0.0139 - acc: 0.9959 - val_loss: 0.0251 - val_acc: 0.9922
Epoch 7/7
60000/60000 [==============================] - 16s 273us/step - loss: 0.0119 - acc: 0.9963 - val_loss: 0.0245 - val_acc: 0.9917
Test loss: 0.02446521243014722
Test accuracy: 0.9917
0 None
1 None
2 None
3 None
4 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/7
60000/60000 [==============================] - 24s 397us/step - loss: 0.2556 - acc: 0.9374 - val_loss: 0.0521 - val_acc: 0.9838
Epoch 2/7
60000/60000 [==============================] - 11s 185us/step - loss: 0.0490 - acc: 0.9861 - val_loss: 0.0713 - val_acc: 0.9767
Epoch 3/7
60000/60000 [==============================] - 11s 187us/step - loss: 0.0329 - acc: 0.9903 - val_loss: 0.0368 - val_acc: 0.9882
Epoch 4/7
60000/60000 [==============================] - 11s 186us/step - loss: 0.0239 - acc: 0.9925 - val_loss: 0.0312 - val_acc: 0.9887
Epoch 5/7
60000/60000 [==============================] - 11s 185us/step - loss: 0.0184 - acc: 0.9949 - val_loss: 0.0299 - val_acc: 0.9897
Epoch 6/7
60000/60000 [==============================] - 11s 186us/step - loss: 0.0150 - acc: 0.9952 - val_loss: 0.0299 - val_acc: 0.9909
Epoch 7/7
60000/60000 [==============================] - 11s 188us/step - loss: 0.0120 - acc: 0.9961 - val_loss: 0.0379 - val_acc: 0.9865
Test loss: 0.03792835583733395
Test accuracy: 0.9865
0 None
1 None
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/7
60000/60000 [==============================] - 30s 492us/step - loss: 0.4466 - acc: 0.8704 - val_loss: 0.5546 - val_acc: 0.7915
Epoch 2/7
60000/60000 [==============================] - 16s 270us/step - loss: 0.0899 - acc: 0.9737 - val_loss: 0.1360 - val_acc: 0.9631
Epoch 3/7
60000/60000 [==============================] - 16s 270us/step - loss: 0.0622 - acc: 0.9803 - val_loss: 0.0823 - val_acc: 0.9794
Epoch 4/7
60000/60000 [==============================] - 16s 271us/step - loss: 0.0493 - acc: 0.9840 - val_loss: 0.1050 - val_acc: 0.9741
Epoch 5/7
60000/60000 [==============================] - 16s 270us/step - loss: 0.0407 - acc: 0.9872 - val_loss: 0.0405 - val_acc: 0.9899
Epoch 6/7
60000/60000 [==============================] - 16s 271us/step - loss: 0.0372 - acc: 0.9883 - val_loss: 0.0331 - val_acc: 0.9922
Epoch 7/7
60000/60000 [==============================] - 16s 271us/step - loss: 0.0334 - acc: 0.9894 - val_loss: 0.0403 - val_acc: 0.9907
Test loss: 0.040258437422662975
Test accuracy: 0.9907
0 None
1 None
2 None
3 None
4 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/7
60000/60000 [==============================] - 39s 644us/step - loss: 0.3723 - acc: 0.8905 - val_loss: 0.0880 - val_acc: 0.9746
Epoch 2/7
60000/60000 [==============================] - 26s 433us/step - loss: 0.0752 - acc: 0.9776 - val_loss: 0.0499 - val_acc: 0.9848
Epoch 3/7
60000/60000 [==============================] - 26s 439us/step - loss: 0.0497 - acc: 0.9849 - val_loss: 0.0830 - val_acc: 0.9729
Epoch 4/7
60000/60000 [==============================] - 26s 440us/step - loss: 0.0398 - acc: 0.9874 - val_loss: 0.0689 - val_acc: 0.9784
Epoch 5/7
60000/60000 [==============================] - 26s 436us/step - loss: 0.0327 - acc: 0.9899 - val_loss: 0.0349 - val_acc: 0.9891
Epoch 6/7
60000/60000 [==============================] - 26s 432us/step - loss: 0.0265 - acc: 0.9916 - val_loss: 0.0458 - val_acc: 0.9856
Epoch 7/7
60000/60000 [==============================] - 26s 432us/step - loss: 0.0233 - acc: 0.9927 - val_loss: 0.0425 - val_acc: 0.9872
Test loss: 0.0424509956210386
Test accuracy: 0.9872
0 None
1 None
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/7
60000/60000 [==============================] - 35s 577us/step - loss: 0.2135 - acc: 0.9450 - val_loss: 0.0463 - val_acc: 0.9857
Epoch 2/7
60000/60000 [==============================] - 21s 349us/step - loss: 0.0433 - acc: 0.9877 - val_loss: 0.0634 - val_acc: 0.9781
Epoch 3/7
60000/60000 [==============================] - 21s 352us/step - loss: 0.0302 - acc: 0.9908 - val_loss: 0.0260 - val_acc: 0.9916
Epoch 4/7
60000/60000 [==============================] - 21s 354us/step - loss: 0.0218 - acc: 0.9932 - val_loss: 0.0320 - val_acc: 0.9896
Epoch 5/7
60000/60000 [==============================] - 21s 354us/step - loss: 0.0187 - acc: 0.9943 - val_loss: 0.0223 - val_acc: 0.9941
Epoch 6/7
60000/60000 [==============================] - 21s 350us/step - loss: 0.0139 - acc: 0.9960 - val_loss: 0.0218 - val_acc: 0.9929
Epoch 7/7
60000/60000 [==============================] - 21s 352us/step - loss: 0.0112 - acc: 0.9966 - val_loss: 0.0213 - val_acc: 0.9936
Test loss: 0.02125788994278846
Test accuracy: 0.9936
0 None
1 None
2 None
3 None
4 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/7
60000/60000 [==============================] - 30s 498us/step - loss: 0.3013 - acc: 0.9308 - val_loss: 0.0703 - val_acc: 0.9812
Epoch 2/7
60000/60000 [==============================] - 14s 239us/step - loss: 0.0538 - acc: 0.9859 - val_loss: 0.0467 - val_acc: 0.9860
Epoch 3/7
60000/60000 [==============================] - 14s 240us/step - loss: 0.0349 - acc: 0.9902 - val_loss: 0.0370 - val_acc: 0.9888
Epoch 4/7
60000/60000 [==============================] - 14s 238us/step - loss: 0.0257 - acc: 0.9930 - val_loss: 0.0358 - val_acc: 0.9894
Epoch 5/7
60000/60000 [==============================] - 14s 237us/step - loss: 0.0197 - acc: 0.9946 - val_loss: 0.0326 - val_acc: 0.9893
Epoch 6/7
60000/60000 [==============================] - 14s 237us/step - loss: 0.0159 - acc: 0.9957 - val_loss: 0.0261 - val_acc: 0.9912
Epoch 7/7
60000/60000 [==============================] - 14s 240us/step - loss: 0.0131 - acc: 0.9965 - val_loss: 0.0205 - val_acc: 0.9928
Test loss: 0.020520756585127673
Test accuracy: 0.9928
0 None
1 None
2 None
3 None
4 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/7
60000/60000 [==============================] - 29s 483us/step - loss: 0.2952 - acc: 0.9295 - val_loss: 0.2910 - val_acc: 0.9052
Epoch 2/7
60000/60000 [==============================] - 14s 238us/step - loss: 0.0552 - acc: 0.9851 - val_loss: 0.0482 - val_acc: 0.9854
Epoch 3/7
60000/60000 [==============================] - 14s 239us/step - loss: 0.0343 - acc: 0.9907 - val_loss: 0.0624 - val_acc: 0.9808
Epoch 4/7
60000/60000 [==============================] - 14s 240us/step - loss: 0.0253 - acc: 0.9932 - val_loss: 0.0362 - val_acc: 0.9884
Epoch 5/7
60000/60000 [==============================] - 14s 238us/step - loss: 0.0192 - acc: 0.9949 - val_loss: 0.0335 - val_acc: 0.9896
Epoch 6/7
60000/60000 [==============================] - 14s 236us/step - loss: 0.0163 - acc: 0.9955 - val_loss: 0.0422 - val_acc: 0.9862
Epoch 7/7
60000/60000 [==============================] - 14s 236us/step - loss: 0.0121 - acc: 0.9971 - val_loss: 0.0295 - val_acc: 0.9900
Test loss: 0.029493310446973193
Test accuracy: 0.99
0 None
1 None
2 None
3 None
4 None
5 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/7
60000/60000 [==============================] - 31s 513us/step - loss: 0.2477 - acc: 0.9351 - val_loss: 0.3299 - val_acc: 0.8809
Epoch 2/7
60000/60000 [==============================] - 17s 276us/step - loss: 0.0453 - acc: 0.9866 - val_loss: 0.0409 - val_acc: 0.9876
Epoch 3/7
60000/60000 [==============================] - 17s 277us/step - loss: 0.0316 - acc: 0.9903 - val_loss: 0.0249 - val_acc: 0.9923
Epoch 4/7
60000/60000 [==============================] - 17s 276us/step - loss: 0.0241 - acc: 0.9928 - val_loss: 0.0250 - val_acc: 0.9922
Epoch 5/7
60000/60000 [==============================] - 17s 277us/step - loss: 0.0197 - acc: 0.9940 - val_loss: 0.0290 - val_acc: 0.9905
Epoch 6/7
60000/60000 [==============================] - 17s 277us/step - loss: 0.0154 - acc: 0.9954 - val_loss: 0.0292 - val_acc: 0.9912
Epoch 7/7
60000/60000 [==============================] - 17s 277us/step - loss: 0.0132 - acc: 0.9961 - val_loss: 0.0327 - val_acc: 0.9894
Test loss: 0.03271850580110622
Test accuracy: 0.9894
0 None
1 None
2 None
3 None
4 2
  Evaluated 9 individuals
-- Generation 8 --
0 None
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 7, in evalOneMax
    model = build_model(individual)
  File "/content/individual.py", line 85, in build_model
    outputs.append(l.evaluate([outputs[i - 1], outputs[l.bypass_index]]))
  File "/content/individual.py", line 21, in evaluate
    return func(prev_output)
  File "/usr/local/lib/python3.6/dist-packages/keras/engine/topology.py", line 594, in __call__
    self.build(input_shapes)
  File "/usr/local/lib/python3.6/dist-packages/keras/layers/merge.py", line 90, in build
    output_shape = self._compute_elemwise_op_output_shape(output_shape, shape)
  File "/usr/local/lib/python3.6/dist-packages/keras/layers/merge.py", line 61, in _compute_elemwise_op_output_shape
    str(shape1) + ' ' + str(shape2))
ValueError: Operands could not be broadcast together with shapes (14, 14, 32) (28, 28, 32)
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 124, in remove_dropout
    ind.remove_layer('Dropout')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Dropout layer is found.
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 144, in remove_skip
    ind.remove_layer('Add')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Add layer is found.
1 None
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/7
60000/60000 [==============================] - 33s 556us/step - loss: 0.2070 - acc: 0.9416 - val_loss: 0.0464 - val_acc: 0.9851
Epoch 2/7
60000/60000 [==============================] - 19s 314us/step - loss: 0.0463 - acc: 0.9854 - val_loss: 0.0315 - val_acc: 0.9891
Epoch 3/7
60000/60000 [==============================] - 19s 309us/step - loss: 0.0331 - acc: 0.9898 - val_loss: 0.0635 - val_acc: 0.9801
Epoch 4/7
60000/60000 [==============================] - 18s 308us/step - loss: 0.0245 - acc: 0.9924 - val_loss: 0.0250 - val_acc: 0.9922
Epoch 5/7
60000/60000 [==============================] - 19s 308us/step - loss: 0.0213 - acc: 0.9927 - val_loss: 0.0321 - val_acc: 0.9899
Epoch 6/7
60000/60000 [==============================] - 19s 310us/step - loss: 0.0170 - acc: 0.9948 - val_loss: 0.0219 - val_acc: 0.9923
Epoch 7/7
60000/60000 [==============================] - 19s 310us/step - loss: 0.0121 - acc: 0.9966 - val_loss: 0.0419 - val_acc: 0.9890
Test loss: 0.041934716550009944
Test accuracy: 0.989
0 None
1 None
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/7
60000/60000 [==============================] - 35s 578us/step - loss: 0.2128 - acc: 0.9393 - val_loss: 0.1017 - val_acc: 0.9663
Epoch 2/7
60000/60000 [==============================] - 20s 327us/step - loss: 0.0483 - acc: 0.9850 - val_loss: 0.0310 - val_acc: 0.9910
Epoch 3/7
60000/60000 [==============================] - 20s 326us/step - loss: 0.0329 - acc: 0.9895 - val_loss: 0.0463 - val_acc: 0.9848
Epoch 4/7
60000/60000 [==============================] - 20s 327us/step - loss: 0.0266 - acc: 0.9916 - val_loss: 0.0545 - val_acc: 0.9829
Epoch 5/7
60000/60000 [==============================] - 20s 327us/step - loss: 0.0203 - acc: 0.9935 - val_loss: 0.0291 - val_acc: 0.9905
Epoch 6/7
60000/60000 [==============================] - 20s 329us/step - loss: 0.0173 - acc: 0.9943 - val_loss: 0.0241 - val_acc: 0.9930
Epoch 7/7
60000/60000 [==============================] - 20s 327us/step - loss: 0.0150 - acc: 0.9950 - val_loss: 0.0194 - val_acc: 0.9933
Test loss: 0.019394902365863526
Test accuracy: 0.9933
0 None
1 None
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/7
60000/60000 [==============================] - 31s 515us/step - loss: 0.2478 - acc: 0.9369 - val_loss: 0.0483 - val_acc: 0.9849
Epoch 2/7
60000/60000 [==============================] - 15s 251us/step - loss: 0.0472 - acc: 0.9856 - val_loss: 0.0563 - val_acc: 0.9824
Epoch 3/7
60000/60000 [==============================] - 15s 258us/step - loss: 0.0317 - acc: 0.9903 - val_loss: 0.0389 - val_acc: 0.9881
Epoch 4/7
60000/60000 [==============================] - 15s 254us/step - loss: 0.0235 - acc: 0.9929 - val_loss: 0.0259 - val_acc: 0.9919
Epoch 5/7
60000/60000 [==============================] - 16s 259us/step - loss: 0.0182 - acc: 0.9946 - val_loss: 0.0294 - val_acc: 0.9909
Epoch 6/7
60000/60000 [==============================] - 16s 260us/step - loss: 0.0142 - acc: 0.9958 - val_loss: 0.0263 - val_acc: 0.9912
Epoch 7/7
60000/60000 [==============================] - 15s 252us/step - loss: 0.0112 - acc: 0.9968 - val_loss: 0.0251 - val_acc: 0.9928
Test loss: 0.025060319305062875
Test accuracy: 0.9928
0 None
1 None
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/7
60000/60000 [==============================] - 32s 541us/step - loss: 0.3801 - acc: 0.8865 - val_loss: 0.3267 - val_acc: 0.9013
Epoch 2/7
60000/60000 [==============================] - 17s 286us/step - loss: 0.0777 - acc: 0.9765 - val_loss: 0.0983 - val_acc: 0.9742
Epoch 3/7
60000/60000 [==============================] - 17s 285us/step - loss: 0.0539 - acc: 0.9837 - val_loss: 0.1071 - val_acc: 0.9692
Epoch 4/7
60000/60000 [==============================] - 17s 287us/step - loss: 0.0424 - acc: 0.9868 - val_loss: 0.0478 - val_acc: 0.9866
Epoch 5/7
60000/60000 [==============================] - 17s 283us/step - loss: 0.0393 - acc: 0.9880 - val_loss: 0.0489 - val_acc: 0.9873
Epoch 6/7
60000/60000 [==============================] - 17s 284us/step - loss: 0.0316 - acc: 0.9900 - val_loss: 0.0537 - val_acc: 0.9852
Epoch 7/7
60000/60000 [==============================] - 17s 288us/step - loss: 0.0293 - acc: 0.9910 - val_loss: 0.0369 - val_acc: 0.9903
Test loss: 0.03692760549224913
Test accuracy: 0.9903
0 None
1 None
2 None
3 None
4 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/7
60000/60000 [==============================] - 31s 523us/step - loss: 0.3495 - acc: 0.9224 - val_loss: 0.0800 - val_acc: 0.9778
Epoch 2/7
60000/60000 [==============================] - 16s 263us/step - loss: 0.0556 - acc: 0.9852 - val_loss: 0.0606 - val_acc: 0.9827
Epoch 3/7
60000/60000 [==============================] - 17s 288us/step - loss: 0.0366 - acc: 0.9899 - val_loss: 0.0308 - val_acc: 0.9908
Epoch 4/7
60000/60000 [==============================] - 17s 285us/step - loss: 0.0263 - acc: 0.9928 - val_loss: 0.0359 - val_acc: 0.9893
Epoch 5/7
60000/60000 [==============================] - 15s 258us/step - loss: 0.0209 - acc: 0.9941 - val_loss: 0.0280 - val_acc: 0.9907
Epoch 6/7
60000/60000 [==============================] - 15s 256us/step - loss: 0.0163 - acc: 0.9955 - val_loss: 0.0473 - val_acc: 0.9841
Epoch 7/7
60000/60000 [==============================] - 16s 268us/step - loss: 0.0131 - acc: 0.9963 - val_loss: 0.0256 - val_acc: 0.9923
Test loss: 0.02558672687751241
Test accuracy: 0.9923
0 None
1 None
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/7
60000/60000 [==============================] - 34s 565us/step - loss: 0.3979 - acc: 0.8773 - val_loss: 0.1357 - val_acc: 0.9598
Epoch 2/7
60000/60000 [==============================] - 18s 299us/step - loss: 0.0836 - acc: 0.9747 - val_loss: 0.0779 - val_acc: 0.9771
Epoch 3/7
60000/60000 [==============================] - 18s 296us/step - loss: 0.0589 - acc: 0.9819 - val_loss: 0.0644 - val_acc: 0.9829
Epoch 4/7
60000/60000 [==============================] - 18s 294us/step - loss: 0.0459 - acc: 0.9856 - val_loss: 0.0807 - val_acc: 0.9771
Epoch 5/7
60000/60000 [==============================] - 18s 296us/step - loss: 0.0407 - acc: 0.9876 - val_loss: 0.0438 - val_acc: 0.9900
Epoch 6/7
60000/60000 [==============================] - 18s 295us/step - loss: 0.0333 - acc: 0.9891 - val_loss: 0.0508 - val_acc: 0.9874
Epoch 7/7
60000/60000 [==============================] - 18s 297us/step - loss: 0.0301 - acc: 0.9904 - val_loss: 0.0362 - val_acc: 0.9914
Test loss: 0.03622043140567839
Test accuracy: 0.9914
0 None
1 None
2 None
3 None
4 None
5 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/7
60000/60000 [==============================] - 28s 469us/step - loss: 0.2023 - acc: 0.9494 - val_loss: 0.1432 - val_acc: 0.9523
Epoch 2/7
60000/60000 [==============================] - 13s 209us/step - loss: 0.0433 - acc: 0.9871 - val_loss: 0.0324 - val_acc: 0.9898
Epoch 3/7
60000/60000 [==============================] - 12s 204us/step - loss: 0.0294 - acc: 0.9910 - val_loss: 0.0298 - val_acc: 0.9900
Epoch 4/7
60000/60000 [==============================] - 12s 204us/step - loss: 0.0211 - acc: 0.9932 - val_loss: 0.0230 - val_acc: 0.9921
Epoch 5/7
60000/60000 [==============================] - 12s 204us/step - loss: 0.0145 - acc: 0.9952 - val_loss: 0.0289 - val_acc: 0.9909
Epoch 6/7
60000/60000 [==============================] - 12s 198us/step - loss: 0.0124 - acc: 0.9963 - val_loss: 0.0283 - val_acc: 0.9910
Epoch 7/7
60000/60000 [==============================] - 12s 196us/step - loss: 0.0087 - acc: 0.9974 - val_loss: 0.0341 - val_acc: 0.9892
Test loss: 0.03410509955473099
Test accuracy: 0.9892
0 None
1 None
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/7
60000/60000 [==============================] - 34s 569us/step - loss: 0.2457 - acc: 0.9380 - val_loss: 0.0975 - val_acc: 0.9723
Epoch 2/7
60000/60000 [==============================] - 15s 257us/step - loss: 0.0478 - acc: 0.9857 - val_loss: 0.0363 - val_acc: 0.9887
Epoch 3/7
60000/60000 [==============================] - 15s 255us/step - loss: 0.0324 - acc: 0.9904 - val_loss: 0.0310 - val_acc: 0.9899
Epoch 4/7
60000/60000 [==============================] - 15s 253us/step - loss: 0.0258 - acc: 0.9919 - val_loss: 0.0346 - val_acc: 0.9881
Epoch 5/7
60000/60000 [==============================] - 15s 253us/step - loss: 0.0198 - acc: 0.9940 - val_loss: 0.0250 - val_acc: 0.9918
Epoch 6/7
60000/60000 [==============================] - 16s 260us/step - loss: 0.0159 - acc: 0.9953 - val_loss: 0.0247 - val_acc: 0.9923
Epoch 7/7
60000/60000 [==============================] - 16s 264us/step - loss: 0.0127 - acc: 0.9959 - val_loss: 0.0340 - val_acc: 0.9896
Test loss: 0.03400064586547087
Test accuracy: 0.9896
0 None
1 None
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/7
60000/60000 [==============================] - 36s 605us/step - loss: 0.2356 - acc: 0.9389 - val_loss: 0.0869 - val_acc: 0.9730
Epoch 2/7
60000/60000 [==============================] - 16s 265us/step - loss: 0.0460 - acc: 0.9861 - val_loss: 0.0635 - val_acc: 0.9794
Epoch 3/7
60000/60000 [==============================] - 16s 263us/step - loss: 0.0312 - acc: 0.9901 - val_loss: 0.0780 - val_acc: 0.9743
Epoch 4/7
60000/60000 [==============================] - 16s 264us/step - loss: 0.0231 - acc: 0.9928 - val_loss: 0.0297 - val_acc: 0.9900
Epoch 5/7
60000/60000 [==============================] - 16s 263us/step - loss: 0.0176 - acc: 0.9946 - val_loss: 0.0263 - val_acc: 0.9916
Epoch 6/7
60000/60000 [==============================] - 16s 261us/step - loss: 0.0137 - acc: 0.9957 - val_loss: 0.0289 - val_acc: 0.9916
Epoch 7/7
60000/60000 [==============================] - 16s 262us/step - loss: 0.0101 - acc: 0.9971 - val_loss: 0.0197 - val_acc: 0.9933
Test loss: 0.019697328969882803
Test accuracy: 0.9933
  Evaluated 9 individuals
-- Generation 9 --
[<__main__.SerializedLayer object at 0x7f8afbbf7400>, <__main__.SerializedLayer object at 0x7f8afbbf76a0>, <__main__.SerializedLayer object at 0x7f8afbbf7940>, <__main__.SerializedLayer object at 0x7f8afbbf7be0>, <__main__.SerializedLayer object at 0x7f8afbbf7e80>, <__main__.SerializedLayer object at 0x7f8afbbf9160>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 150)
False
1 1
0 0
[<__main__.SerializedLayer object at 0x7f8afbbfc4e0>, <__main__.SerializedLayer object at 0x7f8afbbfc780>, <__main__.SerializedLayer object at 0x7f8afbbfca20>, <__main__.SerializedLayer object at 0x7f8afbbfccc0>, <__main__.SerializedLayer object at 0x7f8afbbfcf60>, <__main__.SerializedLayer object at 0x7f8afbbff240>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 150)
False
1 1
0 0
[<__main__.SerializedLayer object at 0x7f8afbbff550>, <__main__.SerializedLayer object at 0x7f8afbbff7f0>, <__main__.SerializedLayer object at 0x7f8afbbffa90>, <__main__.SerializedLayer object at 0x7f8afbbffd30>, <__main__.SerializedLayer object at 0x7f8afbbfffd0>, <__main__.SerializedLayer object at 0x7f8afbb812b0>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 150)
False
1 1
0 0
[<__main__.SerializedLayer object at 0x7f8afbb886a0>, <__main__.SerializedLayer object at 0x7f8afbb88940>, <__main__.SerializedLayer object at 0x7f8afbb88be0>, <__main__.SerializedLayer object at 0x7f8afbb88e80>, <__main__.SerializedLayer object at 0x7f8afbb8b160>, <__main__.SerializedLayer object at 0x7f8afbb8b400>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 150)
False
1 3
0 2
0 None
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 124, in remove_dropout
    ind.remove_layer('Dropout')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Dropout layer is found.
1 None
2 None
3 None
4 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/8
60000/60000 [==============================] - 32s 538us/step - loss: 0.3116 - acc: 0.9221 - val_loss: 0.2425 - val_acc: 0.9235
Epoch 2/8
60000/60000 [==============================] - 15s 247us/step - loss: 0.0596 - acc: 0.9833 - val_loss: 0.0447 - val_acc: 0.9862
Epoch 3/8
60000/60000 [==============================] - 15s 251us/step - loss: 0.0390 - acc: 0.9887 - val_loss: 0.0553 - val_acc: 0.9820
Epoch 4/8
60000/60000 [==============================] - 15s 251us/step - loss: 0.0296 - acc: 0.9911 - val_loss: 0.0471 - val_acc: 0.9855
Epoch 5/8
60000/60000 [==============================] - 15s 249us/step - loss: 0.0235 - acc: 0.9931 - val_loss: 0.0396 - val_acc: 0.9868
Epoch 6/8
60000/60000 [==============================] - 15s 250us/step - loss: 0.0178 - acc: 0.9946 - val_loss: 0.0633 - val_acc: 0.9782
Epoch 7/8
60000/60000 [==============================] - 15s 248us/step - loss: 0.0149 - acc: 0.9956 - val_loss: 0.0392 - val_acc: 0.9872
Epoch 8/8
60000/60000 [==============================] - 15s 249us/step - loss: 0.0118 - acc: 0.9967 - val_loss: 0.0288 - val_acc: 0.9909
Test loss: 0.02884860608059098
Test accuracy: 0.9909
0 None
1 None
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/8
60000/60000 [==============================] - 44s 725us/step - loss: 0.2199 - acc: 0.9452 - val_loss: 0.0606 - val_acc: 0.9816
Epoch 2/8
60000/60000 [==============================] - 22s 364us/step - loss: 0.0425 - acc: 0.9876 - val_loss: 0.0323 - val_acc: 0.9903
Epoch 3/8
60000/60000 [==============================] - 22s 365us/step - loss: 0.0277 - acc: 0.9919 - val_loss: 0.0283 - val_acc: 0.9905
Epoch 4/8
60000/60000 [==============================] - 22s 365us/step - loss: 0.0233 - acc: 0.9932 - val_loss: 0.0454 - val_acc: 0.9851
Epoch 5/8
60000/60000 [==============================] - 22s 367us/step - loss: 0.0179 - acc: 0.9945 - val_loss: 0.0459 - val_acc: 0.9863
Epoch 6/8
60000/60000 [==============================] - 22s 365us/step - loss: 0.0143 - acc: 0.9957 - val_loss: 0.0371 - val_acc: 0.9886
Epoch 7/8
60000/60000 [==============================] - 22s 363us/step - loss: 0.0130 - acc: 0.9962 - val_loss: 0.0277 - val_acc: 0.9910
Epoch 8/8
60000/60000 [==============================] - 22s 363us/step - loss: 0.0103 - acc: 0.9970 - val_loss: 0.0255 - val_acc: 0.9917
Test loss: 0.02554900255915709
Test accuracy: 0.9917
0 None
1 0
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/8
60000/60000 [==============================] - 36s 592us/step - loss: 0.2525 - acc: 0.9383 - val_loss: 0.0508 - val_acc: 0.9852
Epoch 2/8
60000/60000 [==============================] - 17s 287us/step - loss: 0.0461 - acc: 0.9869 - val_loss: 0.0486 - val_acc: 0.9846
Epoch 3/8
60000/60000 [==============================] - 17s 285us/step - loss: 0.0317 - acc: 0.9904 - val_loss: 0.0223 - val_acc: 0.9932
Epoch 4/8
60000/60000 [==============================] - 17s 285us/step - loss: 0.0236 - acc: 0.9931 - val_loss: 0.0187 - val_acc: 0.9931
Epoch 5/8
60000/60000 [==============================] - 17s 286us/step - loss: 0.0192 - acc: 0.9942 - val_loss: 0.0247 - val_acc: 0.9911
Epoch 6/8
60000/60000 [==============================] - 17s 285us/step - loss: 0.0155 - acc: 0.9954 - val_loss: 0.0172 - val_acc: 0.9946
Epoch 7/8
60000/60000 [==============================] - 17s 286us/step - loss: 0.0125 - acc: 0.9964 - val_loss: 0.0191 - val_acc: 0.9935
Epoch 8/8
60000/60000 [==============================] - 17s 288us/step - loss: 0.0108 - acc: 0.9969 - val_loss: 0.0178 - val_acc: 0.9945
Test loss: 0.017821716896609722
Test accuracy: 0.9945
0 None
1 None
2 None
3 None
4 None
5 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/8
60000/60000 [==============================] - 37s 613us/step - loss: 0.1950 - acc: 0.9465 - val_loss: 0.2060 - val_acc: 0.9315
Epoch 2/8
60000/60000 [==============================] - 18s 308us/step - loss: 0.0405 - acc: 0.9881 - val_loss: 0.0488 - val_acc: 0.9853
Epoch 3/8
60000/60000 [==============================] - 18s 305us/step - loss: 0.0269 - acc: 0.9916 - val_loss: 0.0476 - val_acc: 0.9847
Epoch 4/8
60000/60000 [==============================] - 18s 307us/step - loss: 0.0198 - acc: 0.9937 - val_loss: 0.0394 - val_acc: 0.9875
Epoch 5/8
60000/60000 [==============================] - 18s 308us/step - loss: 0.0145 - acc: 0.9957 - val_loss: 0.0389 - val_acc: 0.9886
Epoch 6/8
60000/60000 [==============================] - 18s 306us/step - loss: 0.0115 - acc: 0.9966 - val_loss: 0.0309 - val_acc: 0.9895
Epoch 7/8
60000/60000 [==============================] - 18s 306us/step - loss: 0.0089 - acc: 0.9977 - val_loss: 0.0154 - val_acc: 0.9943
Epoch 8/8
60000/60000 [==============================] - 18s 303us/step - loss: 0.0065 - acc: 0.9984 - val_loss: 0.0206 - val_acc: 0.9941
Test loss: 0.020558988783023962
Test accuracy: 0.9941
0 None
1 0
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/8
60000/60000 [==============================] - 34s 565us/step - loss: 0.2347 - acc: 0.9399 - val_loss: 0.0529 - val_acc: 0.9830
Epoch 2/8
60000/60000 [==============================] - 16s 268us/step - loss: 0.0502 - acc: 0.9853 - val_loss: 0.0530 - val_acc: 0.9847
Epoch 3/8
60000/60000 [==============================] - 16s 268us/step - loss: 0.0314 - acc: 0.9907 - val_loss: 0.0533 - val_acc: 0.9828
Epoch 4/8
60000/60000 [==============================] - 16s 266us/step - loss: 0.0236 - acc: 0.9929 - val_loss: 0.0314 - val_acc: 0.9891
Epoch 5/8
60000/60000 [==============================] - 16s 265us/step - loss: 0.0188 - acc: 0.9944 - val_loss: 0.0230 - val_acc: 0.9930
Epoch 6/8
60000/60000 [==============================] - 16s 263us/step - loss: 0.0142 - acc: 0.9961 - val_loss: 0.0227 - val_acc: 0.9923
Epoch 7/8
60000/60000 [==============================] - 16s 265us/step - loss: 0.0116 - acc: 0.9965 - val_loss: 0.0298 - val_acc: 0.9922
Epoch 8/8
60000/60000 [==============================] - 16s 265us/step - loss: 0.0093 - acc: 0.9973 - val_loss: 0.0301 - val_acc: 0.9902
Test loss: 0.03014340178842831
Test accuracy: 0.9902
0 None
1 0
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/8
60000/60000 [==============================] - 36s 595us/step - loss: 0.2420 - acc: 0.9411 - val_loss: 0.0836 - val_acc: 0.9753
Epoch 2/8
60000/60000 [==============================] - 17s 284us/step - loss: 0.0440 - acc: 0.9873 - val_loss: 0.0271 - val_acc: 0.9909
Epoch 3/8
60000/60000 [==============================] - 17s 281us/step - loss: 0.0300 - acc: 0.9910 - val_loss: 0.0259 - val_acc: 0.9924
Epoch 4/8
60000/60000 [==============================] - 17s 282us/step - loss: 0.0228 - acc: 0.9930 - val_loss: 0.0329 - val_acc: 0.9899
Epoch 5/8
60000/60000 [==============================] - 17s 281us/step - loss: 0.0183 - acc: 0.9945 - val_loss: 0.0276 - val_acc: 0.9916
Epoch 6/8
60000/60000 [==============================] - 17s 283us/step - loss: 0.0151 - acc: 0.9951 - val_loss: 0.0244 - val_acc: 0.9926
Epoch 7/8
60000/60000 [==============================] - 17s 284us/step - loss: 0.0121 - acc: 0.9963 - val_loss: 0.0289 - val_acc: 0.9910
Epoch 8/8
60000/60000 [==============================] - 17s 283us/step - loss: 0.0091 - acc: 0.9974 - val_loss: 0.0250 - val_acc: 0.9928
Test loss: 0.024976313246780773
Test accuracy: 0.9928
0 None
1 None
2 None
3 None
4 None
5 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/8
60000/60000 [==============================] - 36s 599us/step - loss: 0.2325 - acc: 0.9432 - val_loss: 0.0840 - val_acc: 0.9730
Epoch 2/8
60000/60000 [==============================] - 17s 279us/step - loss: 0.0436 - acc: 0.9872 - val_loss: 0.0314 - val_acc: 0.9892
Epoch 3/8
60000/60000 [==============================] - 17s 280us/step - loss: 0.0303 - acc: 0.9911 - val_loss: 0.0455 - val_acc: 0.9856
Epoch 4/8
60000/60000 [==============================] - 17s 281us/step - loss: 0.0222 - acc: 0.9934 - val_loss: 0.0236 - val_acc: 0.9917
Epoch 5/8
60000/60000 [==============================] - 17s 283us/step - loss: 0.0181 - acc: 0.9941 - val_loss: 0.0359 - val_acc: 0.9871
Epoch 6/8
60000/60000 [==============================] - 17s 281us/step - loss: 0.0152 - acc: 0.9955 - val_loss: 0.0269 - val_acc: 0.9907
Epoch 7/8
60000/60000 [==============================] - 17s 279us/step - loss: 0.0110 - acc: 0.9969 - val_loss: 0.0312 - val_acc: 0.9901
Epoch 8/8
60000/60000 [==============================] - 17s 277us/step - loss: 0.0093 - acc: 0.9972 - val_loss: 0.0176 - val_acc: 0.9941
Test loss: 0.017567070202104514
Test accuracy: 0.9941
0 None
1 None
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/8
60000/60000 [==============================] - 37s 612us/step - loss: 0.2474 - acc: 0.9285 - val_loss: 0.2009 - val_acc: 0.9352
Epoch 2/8
60000/60000 [==============================] - 18s 297us/step - loss: 0.0527 - acc: 0.9834 - val_loss: 0.0561 - val_acc: 0.9818
Epoch 3/8
60000/60000 [==============================] - 18s 299us/step - loss: 0.0371 - acc: 0.9884 - val_loss: 0.0400 - val_acc: 0.9872
Epoch 4/8
60000/60000 [==============================] - 18s 299us/step - loss: 0.0292 - acc: 0.9908 - val_loss: 0.0979 - val_acc: 0.9721
Epoch 5/8
60000/60000 [==============================] - 18s 294us/step - loss: 0.0236 - acc: 0.9926 - val_loss: 0.0382 - val_acc: 0.9873
Epoch 6/8
60000/60000 [==============================] - 17s 289us/step - loss: 0.0190 - acc: 0.9940 - val_loss: 0.0242 - val_acc: 0.9924
Epoch 7/8
60000/60000 [==============================] - 17s 289us/step - loss: 0.0172 - acc: 0.9946 - val_loss: 0.0324 - val_acc: 0.9898
Epoch 8/8
60000/60000 [==============================] - 17s 290us/step - loss: 0.0144 - acc: 0.9952 - val_loss: 0.0349 - val_acc: 0.9901
Test loss: 0.034939748296454125
Test accuracy: 0.9901
0 None
1 None
2 None
3 2
  Evaluated 9 individuals
-- Generation 10 --
0 None
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 7, in evalOneMax
    model = build_model(individual)
  File "/content/individual.py", line 85, in build_model
    outputs.append(l.evaluate([outputs[i - 1], outputs[l.bypass_index]]))
  File "/content/individual.py", line 21, in evaluate
    return func(prev_output)
  File "/usr/local/lib/python3.6/dist-packages/keras/engine/topology.py", line 594, in __call__
    self.build(input_shapes)
  File "/usr/local/lib/python3.6/dist-packages/keras/layers/merge.py", line 90, in build
    output_shape = self._compute_elemwise_op_output_shape(output_shape, shape)
  File "/usr/local/lib/python3.6/dist-packages/keras/layers/merge.py", line 61, in _compute_elemwise_op_output_shape
    str(shape1) + ' ' + str(shape2))
ValueError: Operands could not be broadcast together with shapes (14, 14, 32) (28, 28, 32)
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 153, in remove_concatenate
    ind.remove_layer('Concatenate')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Concatenate layer is found.
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 153, in remove_concatenate
    ind.remove_layer('Concatenate')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Concatenate layer is found.
1 0
2 None
3 None
4 None
5 None
6 None
7 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/9
60000/60000 [==============================] - 36s 593us/step - loss: 0.4380 - acc: 0.8685 - val_loss: 0.1315 - val_acc: 0.9646
Epoch 2/9
60000/60000 [==============================] - 17s 283us/step - loss: 0.0946 - acc: 0.9720 - val_loss: 0.0795 - val_acc: 0.9778
Epoch 3/9
60000/60000 [==============================] - 17s 285us/step - loss: 0.0631 - acc: 0.9805 - val_loss: 0.0616 - val_acc: 0.9826
Epoch 4/9
60000/60000 [==============================] - 17s 281us/step - loss: 0.0495 - acc: 0.9849 - val_loss: 0.0568 - val_acc: 0.9849
Epoch 5/9
60000/60000 [==============================] - 17s 286us/step - loss: 0.0421 - acc: 0.9869 - val_loss: 0.0592 - val_acc: 0.9842
Epoch 6/9
60000/60000 [==============================] - 17s 281us/step - loss: 0.0375 - acc: 0.9881 - val_loss: 0.0389 - val_acc: 0.9905
Epoch 7/9
60000/60000 [==============================] - 18s 295us/step - loss: 0.0353 - acc: 0.9889 - val_loss: 0.0561 - val_acc: 0.9822
Epoch 8/9
60000/60000 [==============================] - 18s 296us/step - loss: 0.0321 - acc: 0.9901 - val_loss: 0.1645 - val_acc: 0.9448
Epoch 9/9
60000/60000 [==============================] - 18s 297us/step - loss: 0.0277 - acc: 0.9909 - val_loss: 0.0449 - val_acc: 0.9877
Test loss: 0.04489590355567634
Test accuracy: 0.9877
0 None
1 0
2 None
3 None
4 None
5 None
6 None
7 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/9
60000/60000 [==============================] - 36s 602us/step - loss: 0.3993 - acc: 0.8834 - val_loss: 0.2178 - val_acc: 0.9354
Epoch 2/9
60000/60000 [==============================] - 17s 280us/step - loss: 0.0836 - acc: 0.9753 - val_loss: 0.1001 - val_acc: 0.9791
Epoch 3/9
60000/60000 [==============================] - 17s 280us/step - loss: 0.0614 - acc: 0.9813 - val_loss: 0.0778 - val_acc: 0.9847
Epoch 4/9
60000/60000 [==============================] - 17s 283us/step - loss: 0.0475 - acc: 0.9852 - val_loss: 0.0648 - val_acc: 0.9833
Epoch 5/9
60000/60000 [==============================] - 17s 283us/step - loss: 0.0416 - acc: 0.9872 - val_loss: 0.0859 - val_acc: 0.9767
Epoch 6/9
60000/60000 [==============================] - 17s 278us/step - loss: 0.0359 - acc: 0.9892 - val_loss: 0.0588 - val_acc: 0.9846
Epoch 7/9
60000/60000 [==============================] - 17s 289us/step - loss: 0.0315 - acc: 0.9899 - val_loss: 0.0526 - val_acc: 0.9872
Epoch 8/9
60000/60000 [==============================] - 17s 286us/step - loss: 0.0279 - acc: 0.9913 - val_loss: 0.0349 - val_acc: 0.9929
Epoch 9/9
60000/60000 [==============================] - 17s 287us/step - loss: 0.0269 - acc: 0.9913 - val_loss: 0.0480 - val_acc: 0.9862
Test loss: 0.04804995922334492
Test accuracy: 0.9862
0 None
1 0
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/9
60000/60000 [==============================] - 32s 531us/step - loss: 0.2148 - acc: 0.9444 - val_loss: 0.1160 - val_acc: 0.9611
Epoch 2/9
60000/60000 [==============================] - 12s 203us/step - loss: 0.0459 - acc: 0.9863 - val_loss: 0.0484 - val_acc: 0.9833
Epoch 3/9
60000/60000 [==============================] - 12s 200us/step - loss: 0.0305 - acc: 0.9911 - val_loss: 0.0652 - val_acc: 0.9782
Epoch 4/9
60000/60000 [==============================] - 12s 195us/step - loss: 0.0242 - acc: 0.9926 - val_loss: 0.0509 - val_acc: 0.9825
Epoch 5/9
60000/60000 [==============================] - 12s 201us/step - loss: 0.0184 - acc: 0.9944 - val_loss: 0.0429 - val_acc: 0.9870
Epoch 6/9
60000/60000 [==============================] - 12s 199us/step - loss: 0.0142 - acc: 0.9955 - val_loss: 0.0273 - val_acc: 0.9911
Epoch 7/9
60000/60000 [==============================] - 12s 201us/step - loss: 0.0105 - acc: 0.9968 - val_loss: 0.0269 - val_acc: 0.9904
Epoch 8/9
60000/60000 [==============================] - 12s 201us/step - loss: 0.0083 - acc: 0.9975 - val_loss: 0.0239 - val_acc: 0.9930
Epoch 9/9
60000/60000 [==============================] - 12s 202us/step - loss: 0.0064 - acc: 0.9981 - val_loss: 0.0227 - val_acc: 0.9924
Test loss: 0.02273168300668767
Test accuracy: 0.9924
0 None
1 0
2 None
3 None
4 None
5 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/9
60000/60000 [==============================] - 47s 777us/step - loss: 0.3851 - acc: 0.8868 - val_loss: 0.1452 - val_acc: 0.9558
Epoch 2/9
60000/60000 [==============================] - 27s 447us/step - loss: 0.0835 - acc: 0.9756 - val_loss: 0.0608 - val_acc: 0.9792
Epoch 3/9
60000/60000 [==============================] - 27s 447us/step - loss: 0.0560 - acc: 0.9826 - val_loss: 0.0675 - val_acc: 0.9787
Epoch 4/9
60000/60000 [==============================] - 27s 451us/step - loss: 0.0436 - acc: 0.9866 - val_loss: 0.0458 - val_acc: 0.9842
Epoch 5/9
60000/60000 [==============================] - 27s 453us/step - loss: 0.0350 - acc: 0.9894 - val_loss: 0.0697 - val_acc: 0.9792
Epoch 6/9
60000/60000 [==============================] - 27s 447us/step - loss: 0.0294 - acc: 0.9911 - val_loss: 0.0382 - val_acc: 0.9874
Epoch 7/9
60000/60000 [==============================] - 27s 447us/step - loss: 0.0257 - acc: 0.9924 - val_loss: 0.0358 - val_acc: 0.9880
Epoch 8/9
60000/60000 [==============================] - 27s 448us/step - loss: 0.0215 - acc: 0.9934 - val_loss: 0.0308 - val_acc: 0.9901
Epoch 9/9
60000/60000 [==============================] - 27s 450us/step - loss: 0.0196 - acc: 0.9938 - val_loss: 0.0350 - val_acc: 0.9870
Test loss: 0.034954685881338085
Test accuracy: 0.987
0 None
1 0
2 None
3 None
4 None
5 None
6 None
7 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/9
60000/60000 [==============================] - 40s 675us/step - loss: 0.2337 - acc: 0.9382 - val_loss: 0.0649 - val_acc: 0.9811
Epoch 2/9
60000/60000 [==============================] - 19s 315us/step - loss: 0.0443 - acc: 0.9869 - val_loss: 0.0481 - val_acc: 0.9841
Epoch 3/9
60000/60000 [==============================] - 19s 317us/step - loss: 0.0305 - acc: 0.9906 - val_loss: 0.0636 - val_acc: 0.9785
Epoch 4/9
60000/60000 [==============================] - 19s 316us/step - loss: 0.0234 - acc: 0.9930 - val_loss: 0.0563 - val_acc: 0.9820
Epoch 5/9
60000/60000 [==============================] - 19s 319us/step - loss: 0.0188 - acc: 0.9942 - val_loss: 0.0207 - val_acc: 0.9931
Epoch 6/9
60000/60000 [==============================] - 19s 317us/step - loss: 0.0155 - acc: 0.9952 - val_loss: 0.0187 - val_acc: 0.9933
Epoch 7/9
60000/60000 [==============================] - 19s 314us/step - loss: 0.0125 - acc: 0.9960 - val_loss: 0.0259 - val_acc: 0.9912
Epoch 8/9
60000/60000 [==============================] - 19s 317us/step - loss: 0.0109 - acc: 0.9970 - val_loss: 0.0227 - val_acc: 0.9933
Epoch 9/9
60000/60000 [==============================] - 19s 316us/step - loss: 0.0091 - acc: 0.9971 - val_loss: 0.0171 - val_acc: 0.9946
Test loss: 0.01714064157342582
Test accuracy: 0.9946
0 None
1 0
2 None
3 None
4 None
5 None
6 None
7 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/9
60000/60000 [==============================] - 37s 623us/step - loss: 0.4137 - acc: 0.8790 - val_loss: 0.1716 - val_acc: 0.9476
Epoch 2/9
60000/60000 [==============================] - 17s 289us/step - loss: 0.0831 - acc: 0.9753 - val_loss: 0.0594 - val_acc: 0.9852
Epoch 3/9
60000/60000 [==============================] - 17s 287us/step - loss: 0.0578 - acc: 0.9825 - val_loss: 0.0680 - val_acc: 0.9850
Epoch 4/9
60000/60000 [==============================] - 17s 287us/step - loss: 0.0454 - acc: 0.9854 - val_loss: 0.0583 - val_acc: 0.9873
Epoch 5/9
60000/60000 [==============================] - 17s 285us/step - loss: 0.0411 - acc: 0.9867 - val_loss: 0.0442 - val_acc: 0.9896
Epoch 6/9
60000/60000 [==============================] - 17s 288us/step - loss: 0.0342 - acc: 0.9899 - val_loss: 0.0435 - val_acc: 0.9891
Epoch 7/9
60000/60000 [==============================] - 17s 287us/step - loss: 0.0311 - acc: 0.9903 - val_loss: 0.0564 - val_acc: 0.9835
Epoch 8/9
60000/60000 [==============================] - 17s 289us/step - loss: 0.0275 - acc: 0.9912 - val_loss: 0.0360 - val_acc: 0.9900
Epoch 9/9
60000/60000 [==============================] - 17s 288us/step - loss: 0.0251 - acc: 0.9921 - val_loss: 0.0316 - val_acc: 0.9915
Test loss: 0.03164692164678127
Test accuracy: 0.9915
0 None
1 0
2 None
3 None
4 None
5 None
6 None
7 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/9
60000/60000 [==============================] - 38s 633us/step - loss: 0.2421 - acc: 0.9382 - val_loss: 0.0518 - val_acc: 0.9830
Epoch 2/9
60000/60000 [==============================] - 16s 262us/step - loss: 0.0492 - acc: 0.9857 - val_loss: 0.0576 - val_acc: 0.9811
Epoch 3/9
60000/60000 [==============================] - 16s 264us/step - loss: 0.0338 - acc: 0.9901 - val_loss: 0.0335 - val_acc: 0.9898
Epoch 4/9
60000/60000 [==============================] - 16s 266us/step - loss: 0.0265 - acc: 0.9917 - val_loss: 0.0244 - val_acc: 0.9917
Epoch 5/9
60000/60000 [==============================] - 16s 265us/step - loss: 0.0200 - acc: 0.9940 - val_loss: 0.0342 - val_acc: 0.9892
Epoch 6/9
60000/60000 [==============================] - 16s 267us/step - loss: 0.0156 - acc: 0.9951 - val_loss: 0.0234 - val_acc: 0.9920
Epoch 7/9
60000/60000 [==============================] - 16s 262us/step - loss: 0.0123 - acc: 0.9963 - val_loss: 0.0326 - val_acc: 0.9902
Epoch 8/9
60000/60000 [==============================] - 16s 262us/step - loss: 0.0096 - acc: 0.9974 - val_loss: 0.0329 - val_acc: 0.9891
Epoch 9/9
60000/60000 [==============================] - 16s 261us/step - loss: 0.0083 - acc: 0.9975 - val_loss: 0.0300 - val_acc: 0.9905
Test loss: 0.030041206093037908
Test accuracy: 0.9905
0 None
1 0
2 None
3 None
4 None
5 None
6 None
7 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/9
60000/60000 [==============================] - 45s 753us/step - loss: 0.2072 - acc: 0.9437 - val_loss: 0.1301 - val_acc: 0.9607
Epoch 2/9
60000/60000 [==============================] - 22s 370us/step - loss: 0.0430 - acc: 0.9869 - val_loss: 0.0426 - val_acc: 0.9865
Epoch 3/9
60000/60000 [==============================] - 22s 365us/step - loss: 0.0297 - acc: 0.9911 - val_loss: 0.0329 - val_acc: 0.9889
Epoch 4/9
60000/60000 [==============================] - 22s 368us/step - loss: 0.0220 - acc: 0.9932 - val_loss: 0.0246 - val_acc: 0.9916
Epoch 5/9
60000/60000 [==============================] - 22s 370us/step - loss: 0.0188 - acc: 0.9940 - val_loss: 0.0279 - val_acc: 0.9910
Epoch 6/9
60000/60000 [==============================] - 22s 372us/step - loss: 0.0144 - acc: 0.9959 - val_loss: 0.0243 - val_acc: 0.9928
Epoch 7/9
60000/60000 [==============================] - 22s 368us/step - loss: 0.0120 - acc: 0.9960 - val_loss: 0.0230 - val_acc: 0.9932
Epoch 8/9
60000/60000 [==============================] - 22s 363us/step - loss: 0.0096 - acc: 0.9971 - val_loss: 0.0185 - val_acc: 0.9934
Epoch 9/9
60000/60000 [==============================] - 22s 363us/step - loss: 0.0081 - acc: 0.9977 - val_loss: 0.0198 - val_acc: 0.9944
Test loss: 0.019835914421513733
Test accuracy: 0.9944
0 None
1 0
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/9
60000/60000 [==============================] - 40s 660us/step - loss: 0.2513 - acc: 0.9375 - val_loss: 0.1587 - val_acc: 0.9513
Epoch 2/9
60000/60000 [==============================] - 17s 286us/step - loss: 0.0477 - acc: 0.9862 - val_loss: 0.0445 - val_acc: 0.9868
Epoch 3/9
60000/60000 [==============================] - 17s 285us/step - loss: 0.0319 - acc: 0.9906 - val_loss: 0.0362 - val_acc: 0.9888
Epoch 4/9
60000/60000 [==============================] - 17s 283us/step - loss: 0.0236 - acc: 0.9929 - val_loss: 0.0933 - val_acc: 0.9695
Epoch 5/9
60000/60000 [==============================] - 17s 285us/step - loss: 0.0183 - acc: 0.9944 - val_loss: 0.0476 - val_acc: 0.9844
Epoch 6/9
60000/60000 [==============================] - 17s 285us/step - loss: 0.0158 - acc: 0.9951 - val_loss: 0.0240 - val_acc: 0.9920
Epoch 7/9
60000/60000 [==============================] - 17s 285us/step - loss: 0.0125 - acc: 0.9962 - val_loss: 0.0222 - val_acc: 0.9925
Epoch 8/9
60000/60000 [==============================] - 17s 287us/step - loss: 0.0094 - acc: 0.9972 - val_loss: 0.0207 - val_acc: 0.9935
Epoch 9/9
60000/60000 [==============================] - 17s 286us/step - loss: 0.0077 - acc: 0.9977 - val_loss: 0.0278 - val_acc: 0.9907
Test loss: 0.027768656865598314
Test accuracy: 0.9907
  Evaluated 9 individuals
-- Generation 11 --
[<__main__.SerializedLayer object at 0x7f8aeb107b70>, <__main__.SerializedLayer object at 0x7f8aeb107e10>, <__main__.SerializedLayer object at 0x7f8aeb10a0f0>, <__main__.SerializedLayer object at 0x7f8aeb10a390>, <__main__.SerializedLayer object at 0x7f8aeb10a630>, <__main__.SerializedLayer object at 0x7f8aeb10a8d0>, <__main__.SerializedLayer object at 0x7f8aeb10ab70>, <__main__.SerializedLayer object at 0x7f8aeb10ae10>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 150)
False
1 6
0 3
[<__main__.SerializedLayer object at 0x7f8aeb110710>, <__main__.SerializedLayer object at 0x7f8aeb1109b0>, <__main__.SerializedLayer object at 0x7f8aeb110c50>, <__main__.SerializedLayer object at 0x7f8aeb110ef0>, <__main__.SerializedLayer object at 0x7f8aeb1141d0>, <__main__.SerializedLayer object at 0x7f8aeb114470>, <__main__.SerializedLayer object at 0x7f8aeb114710>, <__main__.SerializedLayer object at 0x7f8aeb1149b0>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 150)
False
1 2
0 1
[<__main__.SerializedLayer object at 0x7f8aeb114cc0>, <__main__.SerializedLayer object at 0x7f8aeb114f60>, <__main__.SerializedLayer object at 0x7f8aeb117240>, <__main__.SerializedLayer object at 0x7f8aeb1174e0>, <__main__.SerializedLayer object at 0x7f8aeb117780>, <__main__.SerializedLayer object at 0x7f8aeb117a20>, <__main__.SerializedLayer object at 0x7f8aeb117cc0>, <__main__.SerializedLayer object at 0x7f8aeb117f60>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 124, in remove_dropout
    ind.remove_layer('Dropout')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Dropout layer is found.
(14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 150)
False
1 1
0 0
0 None
1 0
2 None
3 None
4 None
5 None
6 None
7 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/9
60000/60000 [==============================] - 41s 690us/step - loss: 0.2363 - acc: 0.9358 - val_loss: 0.1767 - val_acc: 0.9432
Epoch 2/9
60000/60000 [==============================] - 19s 316us/step - loss: 0.0473 - acc: 0.9856 - val_loss: 0.0865 - val_acc: 0.9702
Epoch 3/9
60000/60000 [==============================] - 19s 318us/step - loss: 0.0329 - acc: 0.9901 - val_loss: 0.1141 - val_acc: 0.9619
Epoch 4/9
60000/60000 [==============================] - 19s 318us/step - loss: 0.0253 - acc: 0.9927 - val_loss: 0.0309 - val_acc: 0.9903
Epoch 5/9
60000/60000 [==============================] - 19s 321us/step - loss: 0.0211 - acc: 0.9935 - val_loss: 0.0231 - val_acc: 0.9921
Epoch 6/9
60000/60000 [==============================] - 19s 319us/step - loss: 0.0170 - acc: 0.9945 - val_loss: 0.0572 - val_acc: 0.9829
Epoch 7/9
60000/60000 [==============================] - 19s 320us/step - loss: 0.0138 - acc: 0.9957 - val_loss: 0.0250 - val_acc: 0.9924
Epoch 8/9
60000/60000 [==============================] - 19s 317us/step - loss: 0.0120 - acc: 0.9963 - val_loss: 0.0338 - val_acc: 0.9892
Epoch 9/9
60000/60000 [==============================] - 19s 314us/step - loss: 0.0100 - acc: 0.9970 - val_loss: 0.0271 - val_acc: 0.9921
Test loss: 0.027056623901685815
Test accuracy: 0.9921
0 None
1 None
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/9
60000/60000 [==============================] - 42s 692us/step - loss: 0.2269 - acc: 0.9423 - val_loss: 0.0454 - val_acc: 0.9870
Epoch 2/9
60000/60000 [==============================] - 18s 307us/step - loss: 0.0472 - acc: 0.9859 - val_loss: 0.0529 - val_acc: 0.9832
Epoch 3/9
60000/60000 [==============================] - 18s 305us/step - loss: 0.0314 - acc: 0.9905 - val_loss: 0.0620 - val_acc: 0.9803
Epoch 4/9
60000/60000 [==============================] - 18s 306us/step - loss: 0.0249 - acc: 0.9923 - val_loss: 0.0646 - val_acc: 0.9807
Epoch 5/9
60000/60000 [==============================] - 19s 315us/step - loss: 0.0198 - acc: 0.9940 - val_loss: 0.0222 - val_acc: 0.9925
Epoch 6/9
60000/60000 [==============================] - 19s 319us/step - loss: 0.0164 - acc: 0.9947 - val_loss: 0.0281 - val_acc: 0.9914
Epoch 7/9
60000/60000 [==============================] - 19s 319us/step - loss: 0.0135 - acc: 0.9958 - val_loss: 0.0183 - val_acc: 0.9947
Epoch 8/9
60000/60000 [==============================] - 19s 317us/step - loss: 0.0112 - acc: 0.9965 - val_loss: 0.0195 - val_acc: 0.9940
Epoch 9/9
60000/60000 [==============================] - 19s 317us/step - loss: 0.0086 - acc: 0.9975 - val_loss: 0.0177 - val_acc: 0.9941
Test loss: 0.01771725464980118
Test accuracy: 0.9941
0 None
1 0
2 None
3 None
4 None
5 None
6 None
7 None
8 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/9
60000/60000 [==============================] - 43s 715us/step - loss: 0.3113 - acc: 0.9061 - val_loss: 0.1747 - val_acc: 0.9547
Epoch 2/9
60000/60000 [==============================] - 21s 347us/step - loss: 0.0667 - acc: 0.9801 - val_loss: 0.1068 - val_acc: 0.9764
Epoch 3/9
60000/60000 [==============================] - 20s 331us/step - loss: 0.0468 - acc: 0.9852 - val_loss: 0.0616 - val_acc: 0.9807
Epoch 4/9
60000/60000 [==============================] - 19s 319us/step - loss: 0.0388 - acc: 0.9879 - val_loss: 0.1027 - val_acc: 0.9653
Epoch 5/9
60000/60000 [==============================] - 19s 321us/step - loss: 0.0313 - acc: 0.9903 - val_loss: 0.0367 - val_acc: 0.9905
Epoch 6/9
60000/60000 [==============================] - 19s 320us/step - loss: 0.0286 - acc: 0.9910 - val_loss: 0.0341 - val_acc: 0.9904
Epoch 7/9
60000/60000 [==============================] - 19s 321us/step - loss: 0.0247 - acc: 0.9926 - val_loss: 0.0384 - val_acc: 0.9882
Epoch 8/9
60000/60000 [==============================] - 19s 323us/step - loss: 0.0227 - acc: 0.9925 - val_loss: 0.0480 - val_acc: 0.9871
Epoch 9/9
60000/60000 [==============================] - 19s 325us/step - loss: 0.0210 - acc: 0.9936 - val_loss: 0.0320 - val_acc: 0.9922
Test loss: 0.03200601350553334
Test accuracy: 0.9922
0 None
1 0
2 None
3 None
4 None
5 None
6 3
0 None
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 7, in evalOneMax
    model = build_model(individual)
  File "/content/individual.py", line 85, in build_model
    outputs.append(l.evaluate([outputs[i - 1], outputs[l.bypass_index]]))
  File "/content/individual.py", line 21, in evaluate
    return func(prev_output)
  File "/usr/local/lib/python3.6/dist-packages/keras/engine/topology.py", line 594, in __call__
    self.build(input_shapes)
  File "/usr/local/lib/python3.6/dist-packages/keras/layers/merge.py", line 90, in build
    output_shape = self._compute_elemwise_op_output_shape(output_shape, shape)
  File "/usr/local/lib/python3.6/dist-packages/keras/layers/merge.py", line 61, in _compute_elemwise_op_output_shape
    str(shape1) + ' ' + str(shape2))
ValueError: Operands could not be broadcast together with shapes (14, 14, 32) (28, 28, 32)
1 0
2 None
3 None
4 None
5 None
6 None
7 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/9
60000/60000 [==============================] - 38s 640us/step - loss: 0.2366 - acc: 0.9392 - val_loss: 0.0579 - val_acc: 0.9820
Epoch 2/9
60000/60000 [==============================] - 17s 277us/step - loss: 0.0458 - acc: 0.9865 - val_loss: 0.0897 - val_acc: 0.9717
Epoch 3/9
60000/60000 [==============================] - 16s 274us/step - loss: 0.0311 - acc: 0.9905 - val_loss: 0.0310 - val_acc: 0.9902
Epoch 4/9
60000/60000 [==============================] - 16s 271us/step - loss: 0.0241 - acc: 0.9922 - val_loss: 0.0553 - val_acc: 0.9816
Epoch 5/9
60000/60000 [==============================] - 16s 274us/step - loss: 0.0191 - acc: 0.9942 - val_loss: 0.0268 - val_acc: 0.9908
Epoch 6/9
60000/60000 [==============================] - 17s 277us/step - loss: 0.0153 - acc: 0.9953 - val_loss: 0.0278 - val_acc: 0.9908
Epoch 7/9
60000/60000 [==============================] - 16s 272us/step - loss: 0.0127 - acc: 0.9958 - val_loss: 0.0759 - val_acc: 0.9788
Epoch 8/9
60000/60000 [==============================] - 16s 269us/step - loss: 0.0105 - acc: 0.9965 - val_loss: 0.0443 - val_acc: 0.9858
Epoch 9/9
60000/60000 [==============================] - 16s 274us/step - loss: 0.0083 - acc: 0.9975 - val_loss: 0.0285 - val_acc: 0.9917
Test loss: 0.02854946890920328
Test accuracy: 0.9917
0 None
1 0
2 1
3 None
4 None
5 None
6 None
7 None
8 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/9
60000/60000 [==============================] - 44s 734us/step - loss: 0.2045 - acc: 0.9442 - val_loss: 0.3665 - val_acc: 0.8928
Epoch 2/9
60000/60000 [==============================] - 20s 331us/step - loss: 0.0416 - acc: 0.9874 - val_loss: 0.0338 - val_acc: 0.9902
Epoch 3/9
60000/60000 [==============================] - 20s 329us/step - loss: 0.0291 - acc: 0.9914 - val_loss: 0.0440 - val_acc: 0.9866
Epoch 4/9
60000/60000 [==============================] - 20s 327us/step - loss: 0.0224 - acc: 0.9933 - val_loss: 0.0295 - val_acc: 0.9909
Epoch 5/9
60000/60000 [==============================] - 20s 328us/step - loss: 0.0178 - acc: 0.9944 - val_loss: 0.0553 - val_acc: 0.9827
Epoch 6/9
60000/60000 [==============================] - 20s 330us/step - loss: 0.0152 - acc: 0.9953 - val_loss: 0.0287 - val_acc: 0.9896
Epoch 7/9
60000/60000 [==============================] - 20s 329us/step - loss: 0.0125 - acc: 0.9961 - val_loss: 0.0252 - val_acc: 0.9917
Epoch 8/9
60000/60000 [==============================] - 20s 328us/step - loss: 0.0100 - acc: 0.9973 - val_loss: 0.0241 - val_acc: 0.9921
Epoch 9/9
60000/60000 [==============================] - 20s 326us/step - loss: 0.0081 - acc: 0.9974 - val_loss: 0.0268 - val_acc: 0.9925
Test loss: 0.02680330873466737
Test accuracy: 0.9925
0 None
1 0
2 0
3 None
4 None
5 None
6 None
7 None
8 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/9
60000/60000 [==============================] - 45s 743us/step - loss: 0.2318 - acc: 0.9397 - val_loss: 0.0749 - val_acc: 0.9757
Epoch 2/9
60000/60000 [==============================] - 20s 328us/step - loss: 0.0462 - acc: 0.9859 - val_loss: 0.2821 - val_acc: 0.9037
Epoch 3/9
60000/60000 [==============================] - 20s 329us/step - loss: 0.0317 - acc: 0.9905 - val_loss: 0.0346 - val_acc: 0.9885
Epoch 4/9
60000/60000 [==============================] - 20s 331us/step - loss: 0.0256 - acc: 0.9920 - val_loss: 0.0998 - val_acc: 0.9675
Epoch 5/9
60000/60000 [==============================] - 20s 326us/step - loss: 0.0206 - acc: 0.9937 - val_loss: 0.0325 - val_acc: 0.9896
Epoch 6/9
60000/60000 [==============================] - 19s 323us/step - loss: 0.0174 - acc: 0.9947 - val_loss: 0.0233 - val_acc: 0.9922
Epoch 7/9
60000/60000 [==============================] - 19s 324us/step - loss: 0.0143 - acc: 0.9956 - val_loss: 0.0206 - val_acc: 0.9936
Epoch 8/9
60000/60000 [==============================] - 20s 327us/step - loss: 0.0127 - acc: 0.9958 - val_loss: 0.0241 - val_acc: 0.9920
Epoch 9/9
60000/60000 [==============================] - 20s 326us/step - loss: 0.0112 - acc: 0.9966 - val_loss: 0.0254 - val_acc: 0.9923
Test loss: 0.025383830535563173
Test accuracy: 0.9923
0 None
1 0
2 None
3 None
4 None
5 None
6 None
7 None
8 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/9
60000/60000 [==============================] - 51s 849us/step - loss: 0.1795 - acc: 0.9467 - val_loss: 0.1648 - val_acc: 0.9512
Epoch 2/9
60000/60000 [==============================] - 22s 367us/step - loss: 0.0468 - acc: 0.9857 - val_loss: 0.0755 - val_acc: 0.9741
Epoch 3/9
60000/60000 [==============================] - 22s 374us/step - loss: 0.0329 - acc: 0.9900 - val_loss: 0.0475 - val_acc: 0.9858
Epoch 4/9
60000/60000 [==============================] - 23s 376us/step - loss: 0.0279 - acc: 0.9913 - val_loss: 0.0574 - val_acc: 0.9835
Epoch 5/9
60000/60000 [==============================] - 23s 381us/step - loss: 0.0221 - acc: 0.9931 - val_loss: 0.0425 - val_acc: 0.9866
Epoch 6/9
60000/60000 [==============================] - 23s 378us/step - loss: 0.0177 - acc: 0.9946 - val_loss: 0.0302 - val_acc: 0.9910
Epoch 7/9
60000/60000 [==============================] - 23s 381us/step - loss: 0.0157 - acc: 0.9950 - val_loss: 0.0186 - val_acc: 0.9948
Epoch 8/9
60000/60000 [==============================] - 23s 376us/step - loss: 0.0133 - acc: 0.9959 - val_loss: 0.0241 - val_acc: 0.9930
Epoch 9/9
60000/60000 [==============================] - 22s 373us/step - loss: 0.0114 - acc: 0.9962 - val_loss: 0.0233 - val_acc: 0.9919
Test loss: 0.02334154821556767
Test accuracy: 0.9919
0 None
1 0
2 None
3 None
4 None
5 None
6 None
7 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/9
60000/60000 [==============================] - 49s 816us/step - loss: 0.2506 - acc: 0.9349 - val_loss: 0.0874 - val_acc: 0.9731
Epoch 2/9
60000/60000 [==============================] - 20s 325us/step - loss: 0.0464 - acc: 0.9862 - val_loss: 0.0473 - val_acc: 0.9843
Epoch 3/9
60000/60000 [==============================] - 19s 325us/step - loss: 0.0329 - acc: 0.9899 - val_loss: 0.0301 - val_acc: 0.9899
Epoch 4/9
60000/60000 [==============================] - 20s 326us/step - loss: 0.0257 - acc: 0.9919 - val_loss: 0.0303 - val_acc: 0.9900
Epoch 5/9
60000/60000 [==============================] - 20s 326us/step - loss: 0.0201 - acc: 0.9934 - val_loss: 0.0350 - val_acc: 0.9889
Epoch 6/9
60000/60000 [==============================] - 19s 321us/step - loss: 0.0170 - acc: 0.9948 - val_loss: 0.0451 - val_acc: 0.9858
Epoch 7/9
60000/60000 [==============================] - 19s 319us/step - loss: 0.0135 - acc: 0.9954 - val_loss: 0.0280 - val_acc: 0.9910
Epoch 8/9
60000/60000 [==============================] - 19s 318us/step - loss: 0.0110 - acc: 0.9963 - val_loss: 0.0234 - val_acc: 0.9921
Epoch 9/9
60000/60000 [==============================] - 19s 318us/step - loss: 0.0090 - acc: 0.9973 - val_loss: 0.0326 - val_acc: 0.9912
Test loss: 0.032589939518155
Test accuracy: 0.9912
  Evaluated 9 individuals
-- Generation 12 --
[<__main__.SerializedLayer object at 0x7f8ae19757f0>, <__main__.SerializedLayer object at 0x7f8ae1975a58>, <__main__.SerializedLayer object at 0x7f8ae1975cf8>, <__main__.SerializedLayer object at 0x7f8ae1975f98>, <__main__.SerializedLayer object at 0x7f8ae1978278>, <__main__.SerializedLayer object at 0x7f8ae1978518>, <__main__.SerializedLayer object at 0x7f8ae19787b8>, <__main__.SerializedLayer object at 0x7f8ae1978a58>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 150)
False
1 5
0 4
[<__main__.SerializedLayer object at 0x7f8ae1978d68>, <__main__.SerializedLayer object at 0x7f8ae197b048>, <__main__.SerializedLayer object at 0x7f8ae197b2e8>, <__main__.SerializedLayer object at 0x7f8ae197b588>, <__main__.SerializedLayer object at 0x7f8ae197b828>, <__main__.SerializedLayer object at 0x7f8ae197bac8>, <__main__.SerializedLayer object at 0x7f8ae197bd68>, <__main__.SerializedLayer object at 0x7f8ae197f048>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 150)
False
1 4
0 3
[<__main__.SerializedLayer object at 0x7f8ae197f358>, <__main__.SerializedLayer object at 0x7f8ae197f5f8>, <__main__.SerializedLayer object at 0x7f8ae197f898>, <__main__.SerializedLayer object at 0x7f8ae197fb38>, <__main__.SerializedLayer object at 0x7f8ae197fdd8>, <__main__.SerializedLayer object at 0x7f8ae19020b8>, <__main__.SerializedLayer object at 0x7f8ae1902358>, <__main__.SerializedLayer object at 0x7f8ae19025f8>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 150)
False
1 2
0 1
0 None
1 0
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/10
60000/60000 [==============================] - 44s 732us/step - loss: 0.2905 - acc: 0.9293 - val_loss: 0.0747 - val_acc: 0.9766
Epoch 2/10
60000/60000 [==============================] - 17s 278us/step - loss: 0.0497 - acc: 0.9856 - val_loss: 0.0814 - val_acc: 0.9741
Epoch 3/10
60000/60000 [==============================] - 17s 279us/step - loss: 0.0332 - acc: 0.9902 - val_loss: 0.0531 - val_acc: 0.9826
Epoch 4/10
60000/60000 [==============================] - 17s 277us/step - loss: 0.0236 - acc: 0.9930 - val_loss: 0.0277 - val_acc: 0.9908
Epoch 5/10
60000/60000 [==============================] - 16s 275us/step - loss: 0.0193 - acc: 0.9945 - val_loss: 0.0369 - val_acc: 0.9882
Epoch 6/10
60000/60000 [==============================] - 17s 275us/step - loss: 0.0162 - acc: 0.9953 - val_loss: 0.0536 - val_acc: 0.9827
Epoch 7/10
60000/60000 [==============================] - 17s 279us/step - loss: 0.0133 - acc: 0.9961 - val_loss: 0.0250 - val_acc: 0.9923
Epoch 8/10
60000/60000 [==============================] - 17s 278us/step - loss: 0.0097 - acc: 0.9972 - val_loss: 0.0234 - val_acc: 0.9919
Epoch 9/10
60000/60000 [==============================] - 17s 276us/step - loss: 0.0076 - acc: 0.9982 - val_loss: 0.0269 - val_acc: 0.9912
Epoch 10/10
60000/60000 [==============================] - 16s 275us/step - loss: 0.0058 - acc: 0.9985 - val_loss: 0.0277 - val_acc: 0.9917
Test loss: 0.02772864830621984
Test accuracy: 0.9917
0 None
1 0
2 None
3 None
4 None
5 4
6 None
7 None
8 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/10
60000/60000 [==============================] - 45s 757us/step - loss: 0.2475 - acc: 0.9341 - val_loss: 0.0535 - val_acc: 0.9844
Epoch 2/10
60000/60000 [==============================] - 19s 320us/step - loss: 0.0465 - acc: 0.9861 - val_loss: 0.0559 - val_acc: 0.9826
Epoch 3/10
60000/60000 [==============================] - 19s 324us/step - loss: 0.0331 - acc: 0.9901 - val_loss: 0.0344 - val_acc: 0.9886
Epoch 4/10
60000/60000 [==============================] - 19s 324us/step - loss: 0.0264 - acc: 0.9918 - val_loss: 0.0364 - val_acc: 0.9898
Epoch 5/10
60000/60000 [==============================] - 19s 321us/step - loss: 0.0207 - acc: 0.9935 - val_loss: 0.0322 - val_acc: 0.9901
Epoch 6/10
60000/60000 [==============================] - 19s 321us/step - loss: 0.0170 - acc: 0.9949 - val_loss: 0.0646 - val_acc: 0.9808
Epoch 7/10
60000/60000 [==============================] - 19s 321us/step - loss: 0.0148 - acc: 0.9954 - val_loss: 0.0183 - val_acc: 0.9939
Epoch 8/10
60000/60000 [==============================] - 19s 323us/step - loss: 0.0121 - acc: 0.9963 - val_loss: 0.0316 - val_acc: 0.9899
Epoch 9/10
60000/60000 [==============================] - 19s 323us/step - loss: 0.0102 - acc: 0.9970 - val_loss: 0.0264 - val_acc: 0.9926
Epoch 10/10
60000/60000 [==============================] - 19s 324us/step - loss: 0.0087 - acc: 0.9972 - val_loss: 0.0269 - val_acc: 0.9926
Test loss: 0.026930995563715986
Test accuracy: 0.9926
0 None
1 0
2 None
3 None
4 3
0 None
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 7, in evalOneMax
    model = build_model(individual)
  File "/content/individual.py", line 85, in build_model
    outputs.append(l.evaluate([outputs[i - 1], outputs[l.bypass_index]]))
  File "/content/individual.py", line 21, in evaluate
    return func(prev_output)
  File "/usr/local/lib/python3.6/dist-packages/keras/engine/topology.py", line 594, in __call__
    self.build(input_shapes)
  File "/usr/local/lib/python3.6/dist-packages/keras/layers/merge.py", line 354, in build
    'Got inputs shapes: %s' % (input_shape))
ValueError: A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got inputs shapes: [(None, 14, 14, 32), (None, 28, 28, 32)]
1 0
2 1
3 None
4 None
5 None
6 None
7 None
8 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/10
60000/60000 [==============================] - 45s 751us/step - loss: 0.2143 - acc: 0.9409 - val_loss: 0.0888 - val_acc: 0.9695
Epoch 2/10
60000/60000 [==============================] - 20s 330us/step - loss: 0.0455 - acc: 0.9863 - val_loss: 0.0567 - val_acc: 0.9814
Epoch 3/10
60000/60000 [==============================] - 20s 331us/step - loss: 0.0302 - acc: 0.9908 - val_loss: 0.0312 - val_acc: 0.9906
Epoch 4/10
60000/60000 [==============================] - 20s 332us/step - loss: 0.0233 - acc: 0.9926 - val_loss: 0.0341 - val_acc: 0.9888
Epoch 5/10
60000/60000 [==============================] - 20s 330us/step - loss: 0.0185 - acc: 0.9946 - val_loss: 0.0656 - val_acc: 0.9785
Epoch 6/10
60000/60000 [==============================] - 20s 333us/step - loss: 0.0159 - acc: 0.9948 - val_loss: 0.0496 - val_acc: 0.9840
Epoch 7/10
60000/60000 [==============================] - 20s 333us/step - loss: 0.0128 - acc: 0.9960 - val_loss: 0.0261 - val_acc: 0.9916
Epoch 8/10
60000/60000 [==============================] - 20s 332us/step - loss: 0.0104 - acc: 0.9970 - val_loss: 0.0214 - val_acc: 0.9936
Epoch 9/10
60000/60000 [==============================] - 20s 333us/step - loss: 0.0083 - acc: 0.9977 - val_loss: 0.0261 - val_acc: 0.9905
Epoch 10/10
60000/60000 [==============================] - 20s 332us/step - loss: 0.0066 - acc: 0.9980 - val_loss: 0.0167 - val_acc: 0.9951
Test loss: 0.016728594625663753
Test accuracy: 0.9951
0 None
1 0
2 None
3 None
4 None
5 None
6 None
7 None
8 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/10
60000/60000 [==============================] - 48s 795us/step - loss: 0.3069 - acc: 0.9097 - val_loss: 0.0968 - val_acc: 0.9774
Epoch 2/10
60000/60000 [==============================] - 19s 325us/step - loss: 0.0666 - acc: 0.9798 - val_loss: 0.0938 - val_acc: 0.9768
Epoch 3/10
60000/60000 [==============================] - 19s 323us/step - loss: 0.0478 - acc: 0.9849 - val_loss: 0.0676 - val_acc: 0.9823
Epoch 4/10
60000/60000 [==============================] - 19s 324us/step - loss: 0.0391 - acc: 0.9878 - val_loss: 0.1113 - val_acc: 0.9696
Epoch 5/10
60000/60000 [==============================] - 20s 332us/step - loss: 0.0332 - acc: 0.9896 - val_loss: 0.0741 - val_acc: 0.9799
Epoch 6/10
60000/60000 [==============================] - 21s 342us/step - loss: 0.0299 - acc: 0.9906 - val_loss: 0.0517 - val_acc: 0.9883
Epoch 7/10
60000/60000 [==============================] - 21s 342us/step - loss: 0.0257 - acc: 0.9921 - val_loss: 0.0326 - val_acc: 0.9918
Epoch 8/10
60000/60000 [==============================] - 20s 326us/step - loss: 0.0215 - acc: 0.9933 - val_loss: 0.0311 - val_acc: 0.9910
Epoch 9/10
60000/60000 [==============================] - 21s 347us/step - loss: 0.0216 - acc: 0.9932 - val_loss: 0.0372 - val_acc: 0.9899
Epoch 10/10
60000/60000 [==============================] - 20s 333us/step - loss: 0.0192 - acc: 0.9940 - val_loss: 0.0314 - val_acc: 0.9922
Test loss: 0.031415777054987847
Test accuracy: 0.9922
0 None
1 0
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/10
60000/60000 [==============================] - 46s 768us/step - loss: 0.2391 - acc: 0.9401 - val_loss: 0.0815 - val_acc: 0.9746
Epoch 2/10
60000/60000 [==============================] - 18s 298us/step - loss: 0.0470 - acc: 0.9862 - val_loss: 0.0725 - val_acc: 0.9777
Epoch 3/10
60000/60000 [==============================] - 21s 349us/step - loss: 0.0314 - acc: 0.9910 - val_loss: 0.0295 - val_acc: 0.9899
Epoch 4/10
60000/60000 [==============================] - 20s 334us/step - loss: 0.0241 - acc: 0.9927 - val_loss: 0.0253 - val_acc: 0.9920
Epoch 5/10
60000/60000 [==============================] - 19s 311us/step - loss: 0.0192 - acc: 0.9940 - val_loss: 0.0297 - val_acc: 0.9900
Epoch 6/10
60000/60000 [==============================] - 21s 345us/step - loss: 0.0151 - acc: 0.9953 - val_loss: 0.0456 - val_acc: 0.9854
Epoch 7/10
60000/60000 [==============================] - 19s 309us/step - loss: 0.0127 - acc: 0.9961 - val_loss: 0.0253 - val_acc: 0.9916
Epoch 8/10
60000/60000 [==============================] - 18s 299us/step - loss: 0.0093 - acc: 0.9975 - val_loss: 0.0473 - val_acc: 0.9861
Epoch 9/10
60000/60000 [==============================] - 21s 346us/step - loss: 0.0076 - acc: 0.9979 - val_loss: 0.0283 - val_acc: 0.9906
Epoch 10/10
60000/60000 [==============================] - 18s 308us/step - loss: 0.0063 - acc: 0.9982 - val_loss: 0.0409 - val_acc: 0.9865
Test loss: 0.04090198815513722
Test accuracy: 0.9865
0 None
1 0
2 None
3 None
4 None
5 None
6 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/10
60000/60000 [==============================] - 42s 698us/step - loss: 0.2425 - acc: 0.9353 - val_loss: 0.0534 - val_acc: 0.9844
Epoch 2/10
60000/60000 [==============================] - 15s 257us/step - loss: 0.0503 - acc: 0.9847 - val_loss: 0.0541 - val_acc: 0.9822
Epoch 3/10
60000/60000 [==============================] - 14s 237us/step - loss: 0.0341 - acc: 0.9898 - val_loss: 0.0813 - val_acc: 0.9734
Epoch 4/10
60000/60000 [==============================] - 14s 235us/step - loss: 0.0265 - acc: 0.9919 - val_loss: 0.0296 - val_acc: 0.9907
Epoch 5/10
60000/60000 [==============================] - 14s 234us/step - loss: 0.0215 - acc: 0.9930 - val_loss: 0.0239 - val_acc: 0.9920
Epoch 6/10
60000/60000 [==============================] - 14s 238us/step - loss: 0.0174 - acc: 0.9946 - val_loss: 0.0338 - val_acc: 0.9897
Epoch 7/10
60000/60000 [==============================] - 14s 236us/step - loss: 0.0145 - acc: 0.9955 - val_loss: 0.0203 - val_acc: 0.9939
Epoch 8/10
60000/60000 [==============================] - 14s 231us/step - loss: 0.0124 - acc: 0.9962 - val_loss: 0.0189 - val_acc: 0.9935
Epoch 9/10
60000/60000 [==============================] - 14s 229us/step - loss: 0.0101 - acc: 0.9969 - val_loss: 0.0185 - val_acc: 0.9947
Epoch 10/10
60000/60000 [==============================] - 14s 233us/step - loss: 0.0086 - acc: 0.9975 - val_loss: 0.0163 - val_acc: 0.9944
Test loss: 0.016278329379899516
Test accuracy: 0.9944
0 None
1 0
2 None
3 None
4 None
5 None
6 None
7 None
8 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/10
60000/60000 [==============================] - 44s 726us/step - loss: 0.1916 - acc: 0.9516 - val_loss: 0.0458 - val_acc: 0.9854
Epoch 2/10
60000/60000 [==============================] - 17s 277us/step - loss: 0.0421 - acc: 0.9871 - val_loss: 0.0405 - val_acc: 0.9868
Epoch 3/10
60000/60000 [==============================] - 17s 275us/step - loss: 0.0289 - acc: 0.9910 - val_loss: 0.0513 - val_acc: 0.9826
Epoch 4/10
60000/60000 [==============================] - 16s 273us/step - loss: 0.0227 - acc: 0.9929 - val_loss: 0.0370 - val_acc: 0.9897
Epoch 5/10
60000/60000 [==============================] - 16s 269us/step - loss: 0.0170 - acc: 0.9947 - val_loss: 0.0515 - val_acc: 0.9847
Epoch 6/10
60000/60000 [==============================] - 16s 269us/step - loss: 0.0133 - acc: 0.9960 - val_loss: 0.0222 - val_acc: 0.9927
Epoch 7/10
60000/60000 [==============================] - 16s 268us/step - loss: 0.0106 - acc: 0.9967 - val_loss: 0.0254 - val_acc: 0.9920
Epoch 8/10
60000/60000 [==============================] - 16s 268us/step - loss: 0.0079 - acc: 0.9976 - val_loss: 0.0259 - val_acc: 0.9921
Epoch 9/10
60000/60000 [==============================] - 16s 268us/step - loss: 0.0068 - acc: 0.9980 - val_loss: 0.0441 - val_acc: 0.9868
Epoch 10/10
60000/60000 [==============================] - 16s 272us/step - loss: 0.0050 - acc: 0.9985 - val_loss: 0.0322 - val_acc: 0.9905
Test loss: 0.032243159718244714
Test accuracy: 0.9905
0 None
1 0
2 None
3 None
4 None
5 None
6 None
7 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/10
60000/60000 [==============================] - 47s 790us/step - loss: 0.2071 - acc: 0.9447 - val_loss: 0.0773 - val_acc: 0.9757
Epoch 2/10
60000/60000 [==============================] - 21s 349us/step - loss: 0.0421 - acc: 0.9876 - val_loss: 0.0429 - val_acc: 0.9859
Epoch 3/10
60000/60000 [==============================] - 21s 350us/step - loss: 0.0313 - acc: 0.9908 - val_loss: 0.0375 - val_acc: 0.9891
Epoch 4/10
60000/60000 [==============================] - 21s 350us/step - loss: 0.0235 - acc: 0.9928 - val_loss: 0.0212 - val_acc: 0.9928
Epoch 5/10
60000/60000 [==============================] - 21s 352us/step - loss: 0.0178 - acc: 0.9945 - val_loss: 0.0284 - val_acc: 0.9917
Epoch 6/10
60000/60000 [==============================] - 22s 359us/step - loss: 0.0159 - acc: 0.9951 - val_loss: 0.0335 - val_acc: 0.9891
Epoch 7/10
60000/60000 [==============================] - 21s 350us/step - loss: 0.0123 - acc: 0.9962 - val_loss: 0.0285 - val_acc: 0.9902
Epoch 8/10
60000/60000 [==============================] - 21s 349us/step - loss: 0.0096 - acc: 0.9971 - val_loss: 0.0250 - val_acc: 0.9922
Epoch 9/10
60000/60000 [==============================] - 21s 351us/step - loss: 0.0090 - acc: 0.9972 - val_loss: 0.0166 - val_acc: 0.9937
Epoch 10/10
60000/60000 [==============================] - 21s 352us/step - loss: 0.0068 - acc: 0.9980 - val_loss: 0.0228 - val_acc: 0.9935
Test loss: 0.02277855167422822
Test accuracy: 0.9935
  Evaluated 9 individuals
-- Generation 13 --
[<__main__.SerializedLayer object at 0x7f8ad910e080>, <__main__.SerializedLayer object at 0x7f8ad910ef98>, <__main__.SerializedLayer object at 0x7f8ad910cc50>, <__main__.SerializedLayer object at 0x7f8ad910cba8>, <__main__.SerializedLayer object at 0x7f8ad910ca58>, <__main__.SerializedLayer object at 0x7f8ad910c908>, <__main__.SerializedLayer object at 0x7f8ad910c7b8>, <__main__.SerializedLayer object at 0x7f8ad910c668>, <__main__.SerializedLayer object at 0x7f8ad910c518>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 150)
False
1 7
0 5
[<__main__.SerializedLayer object at 0x7f8ad91b0518>, <__main__.SerializedLayer object at 0x7f8ad91b0a90>, <__main__.SerializedLayer object at 0x7f8ad91b0cc0>, <__main__.SerializedLayer object at 0x7f8ad91b0dd8>, <__main__.SerializedLayer object at 0x7f8ad91b0f28>, <__main__.SerializedLayer object at 0x7f8ad914af60>, <__main__.SerializedLayer object at 0x7f8ad91b0fd0>, <__main__.SerializedLayer object at 0x7f8ad91a8dd8>, <__main__.SerializedLayer object at 0x7f8ad91a8c88>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 124, in remove_dropout
    ind.remove_layer('Dropout')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Dropout layer is found.
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 153, in remove_concatenate
    ind.remove_layer('Concatenate')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Concatenate layer is found.
(14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 150)
False
1 2
0 1
[<__main__.SerializedLayer object at 0x7f8adb66d4a8>, <__main__.SerializedLayer object at 0x7f8adb66d5f8>, <__main__.SerializedLayer object at 0x7f8adb66d828>, <__main__.SerializedLayer object at 0x7f8adb66d8d0>, <__main__.SerializedLayer object at 0x7f8adb66da58>, <__main__.SerializedLayer object at 0x7f8ad91b0c50>, <__main__.SerializedLayer object at 0x7f8ad91a4a20>, <__main__.SerializedLayer object at 0x7f8adb66d240>, <__main__.SerializedLayer object at 0x7f8af9e31be0>]
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (28, 28, 32)
True
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 32)
False
l1: (28, 28, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 32)
True
l1: (14, 14, 32)
l2: (14, 14, 150)
False
l1: (14, 14, 32)
l2: (14, 14, 150)
False
1 8
0 7
0 None
1 0
2 1
3 None
4 None
5 None
6 None
7 None
8 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/10
60000/60000 [==============================] - 45s 750us/step - loss: 0.2335 - acc: 0.9400 - val_loss: 0.1338 - val_acc: 0.9580
Epoch 2/10
60000/60000 [==============================] - 17s 280us/step - loss: 0.0441 - acc: 0.9867 - val_loss: 0.0439 - val_acc: 0.9849
Epoch 3/10
60000/60000 [==============================] - 17s 278us/step - loss: 0.0308 - acc: 0.9902 - val_loss: 0.2805 - val_acc: 0.9060
Epoch 4/10
60000/60000 [==============================] - 17s 277us/step - loss: 0.0220 - acc: 0.9933 - val_loss: 0.0257 - val_acc: 0.9918
Epoch 5/10
60000/60000 [==============================] - 17s 280us/step - loss: 0.0166 - acc: 0.9945 - val_loss: 0.0246 - val_acc: 0.9920
Epoch 6/10
60000/60000 [==============================] - 17s 279us/step - loss: 0.0132 - acc: 0.9959 - val_loss: 0.0238 - val_acc: 0.9927
Epoch 7/10
60000/60000 [==============================] - 17s 276us/step - loss: 0.0096 - acc: 0.9972 - val_loss: 0.0296 - val_acc: 0.9908
Epoch 8/10
60000/60000 [==============================] - 17s 277us/step - loss: 0.0081 - acc: 0.9976 - val_loss: 0.0380 - val_acc: 0.9875
Epoch 9/10
60000/60000 [==============================] - 17s 280us/step - loss: 0.0061 - acc: 0.9981 - val_loss: 0.0313 - val_acc: 0.9912
Epoch 10/10
60000/60000 [==============================] - 17s 277us/step - loss: 0.0056 - acc: 0.9983 - val_loss: 0.0417 - val_acc: 0.9876
Test loss: 0.041652467008217356
Test accuracy: 0.9876
0 None
1 0
2 1
3 None
4 None
5 None
6 None
7 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/10
60000/60000 [==============================] - 48s 805us/step - loss: 0.2723 - acc: 0.9369 - val_loss: 0.0782 - val_acc: 0.9791
Epoch 2/10
60000/60000 [==============================] - 18s 296us/step - loss: 0.0481 - acc: 0.9872 - val_loss: 0.0381 - val_acc: 0.9878
Epoch 3/10
60000/60000 [==============================] - 18s 292us/step - loss: 0.0315 - acc: 0.9909 - val_loss: 0.0401 - val_acc: 0.9882
Epoch 4/10
60000/60000 [==============================] - 18s 296us/step - loss: 0.0241 - acc: 0.9930 - val_loss: 0.0432 - val_acc: 0.9862
Epoch 5/10
60000/60000 [==============================] - 18s 303us/step - loss: 0.0184 - acc: 0.9950 - val_loss: 0.0400 - val_acc: 0.9866
Epoch 6/10
60000/60000 [==============================] - 18s 297us/step - loss: 0.0158 - acc: 0.9955 - val_loss: 0.0324 - val_acc: 0.9885
Epoch 7/10
60000/60000 [==============================] - 19s 316us/step - loss: 0.0121 - acc: 0.9966 - val_loss: 0.0251 - val_acc: 0.9917
Epoch 8/10
60000/60000 [==============================] - 21s 344us/step - loss: 0.0095 - acc: 0.9975 - val_loss: 0.0251 - val_acc: 0.9925
Epoch 9/10
60000/60000 [==============================] - 17s 291us/step - loss: 0.0079 - acc: 0.9977 - val_loss: 0.0237 - val_acc: 0.9929
Epoch 10/10
60000/60000 [==============================] - 18s 298us/step - loss: 0.0061 - acc: 0.9983 - val_loss: 0.0262 - val_acc: 0.9917
Test loss: 0.02623008622646157
Test accuracy: 0.9917
0 None
1 0
2 1
3 None
4 None
5 None
6 None
7 5
8 None
9 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/10
60000/60000 [==============================] - 54s 907us/step - loss: 0.2234 - acc: 0.9401 - val_loss: 0.0559 - val_acc: 0.9831
Epoch 2/10
60000/60000 [==============================] - 21s 348us/step - loss: 0.0437 - acc: 0.9868 - val_loss: 0.0478 - val_acc: 0.9840
Epoch 3/10
60000/60000 [==============================] - 21s 345us/step - loss: 0.0306 - acc: 0.9908 - val_loss: 0.0431 - val_acc: 0.9860
Epoch 4/10
60000/60000 [==============================] - 21s 345us/step - loss: 0.0235 - acc: 0.9924 - val_loss: 0.1282 - val_acc: 0.9555
Epoch 5/10
60000/60000 [==============================] - 21s 345us/step - loss: 0.0182 - acc: 0.9944 - val_loss: 0.0242 - val_acc: 0.9912
Epoch 6/10
60000/60000 [==============================] - 21s 345us/step - loss: 0.0160 - acc: 0.9950 - val_loss: 0.0299 - val_acc: 0.9907
Epoch 7/10
60000/60000 [==============================] - 21s 353us/step - loss: 0.0121 - acc: 0.9964 - val_loss: 0.0298 - val_acc: 0.9903
Epoch 8/10
60000/60000 [==============================] - 21s 354us/step - loss: 0.0101 - acc: 0.9970 - val_loss: 0.0171 - val_acc: 0.9933
Epoch 9/10
60000/60000 [==============================] - 21s 355us/step - loss: 0.0089 - acc: 0.9972 - val_loss: 0.0231 - val_acc: 0.9930
Epoch 10/10
60000/60000 [==============================] - 21s 354us/step - loss: 0.0065 - acc: 0.9980 - val_loss: 0.0232 - val_acc: 0.9927
Test loss: 0.023158888148052937
Test accuracy: 0.9927
0 None
1 0
2 1
3 None
4 None
5 None
6 None
7 None
8 None
9 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/10
60000/60000 [==============================] - 56s 931us/step - loss: 0.1893 - acc: 0.9435 - val_loss: 0.4370 - val_acc: 0.8801
Epoch 2/10
60000/60000 [==============================] - 24s 397us/step - loss: 0.0455 - acc: 0.9856 - val_loss: 0.0512 - val_acc: 0.9837
Epoch 3/10
60000/60000 [==============================] - 25s 410us/step - loss: 0.0330 - acc: 0.9896 - val_loss: 0.0374 - val_acc: 0.9876
Epoch 4/10
60000/60000 [==============================] - 24s 392us/step - loss: 0.0254 - acc: 0.9914 - val_loss: 0.0314 - val_acc: 0.9900
Epoch 5/10
60000/60000 [==============================] - 23s 390us/step - loss: 0.0208 - acc: 0.9938 - val_loss: 0.0296 - val_acc: 0.9895
Epoch 6/10
60000/60000 [==============================] - 23s 382us/step - loss: 0.0173 - acc: 0.9944 - val_loss: 0.1510 - val_acc: 0.9560
Epoch 7/10
60000/60000 [==============================] - 23s 376us/step - loss: 0.0160 - acc: 0.9949 - val_loss: 0.0277 - val_acc: 0.9922
Epoch 8/10
60000/60000 [==============================] - 23s 377us/step - loss: 0.0117 - acc: 0.9962 - val_loss: 0.0326 - val_acc: 0.9895
Epoch 9/10
60000/60000 [==============================] - 23s 381us/step - loss: 0.0113 - acc: 0.9963 - val_loss: 0.0375 - val_acc: 0.9896
Epoch 10/10
60000/60000 [==============================] - 23s 388us/step - loss: 0.0098 - acc: 0.9969 - val_loss: 0.0209 - val_acc: 0.9936
Test loss: 0.02092217238649173
Test accuracy: 0.9936
0 None
1 0
2 1
3 None
4 None
5 None
6 None
7 None
8 None
9 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/10
60000/60000 [==============================] - 55s 914us/step - loss: 0.2010 - acc: 0.9522 - val_loss: 0.1206 - val_acc: 0.9638
Epoch 2/10
60000/60000 [==============================] - 23s 381us/step - loss: 0.0444 - acc: 0.9868 - val_loss: 0.0620 - val_acc: 0.9803
Epoch 3/10
60000/60000 [==============================] - 24s 395us/step - loss: 0.0299 - acc: 0.9911 - val_loss: 0.0329 - val_acc: 0.9902
Epoch 4/10
60000/60000 [==============================] - 24s 394us/step - loss: 0.0240 - acc: 0.9925 - val_loss: 0.0273 - val_acc: 0.9919
Epoch 5/10
60000/60000 [==============================] - 24s 392us/step - loss: 0.0190 - acc: 0.9941 - val_loss: 0.0261 - val_acc: 0.9911
Epoch 6/10
60000/60000 [==============================] - 23s 391us/step - loss: 0.0149 - acc: 0.9955 - val_loss: 0.0295 - val_acc: 0.9913
Epoch 7/10
60000/60000 [==============================] - 24s 404us/step - loss: 0.0125 - acc: 0.9962 - val_loss: 0.0239 - val_acc: 0.9921
Epoch 8/10
60000/60000 [==============================] - 28s 461us/step - loss: 0.0101 - acc: 0.9970 - val_loss: 0.0276 - val_acc: 0.9920
Epoch 9/10
60000/60000 [==============================] - 23s 389us/step - loss: 0.0077 - acc: 0.9978 - val_loss: 0.0261 - val_acc: 0.9926
Epoch 10/10
60000/60000 [==============================] - 23s 390us/step - loss: 0.0056 - acc: 0.9985 - val_loss: 0.0204 - val_acc: 0.9940
Test loss: 0.020429140919986457
Test accuracy: 0.994
0 None
1 0
2 1
3 None
4 None
5 None
6 None
7 None
8 None
9 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/10
60000/60000 [==============================] - 58s 963us/step - loss: 0.2064 - acc: 0.9417 - val_loss: 0.0545 - val_acc: 0.9845
Epoch 2/10
60000/60000 [==============================] - 22s 371us/step - loss: 0.0412 - acc: 0.9876 - val_loss: 0.0336 - val_acc: 0.9893
Epoch 3/10
60000/60000 [==============================] - 22s 372us/step - loss: 0.0295 - acc: 0.9909 - val_loss: 0.0365 - val_acc: 0.9893
Epoch 4/10
60000/60000 [==============================] - 22s 368us/step - loss: 0.0229 - acc: 0.9931 - val_loss: 0.0216 - val_acc: 0.9929
Epoch 5/10
60000/60000 [==============================] - 22s 369us/step - loss: 0.0179 - acc: 0.9943 - val_loss: 0.0292 - val_acc: 0.9922
Epoch 6/10
60000/60000 [==============================] - 22s 368us/step - loss: 0.0147 - acc: 0.9957 - val_loss: 0.0199 - val_acc: 0.9943
Epoch 7/10
60000/60000 [==============================] - 22s 372us/step - loss: 0.0130 - acc: 0.9960 - val_loss: 0.0283 - val_acc: 0.9914
Epoch 8/10
60000/60000 [==============================] - 22s 373us/step - loss: 0.0111 - acc: 0.9966 - val_loss: 0.0242 - val_acc: 0.9932
Epoch 9/10
60000/60000 [==============================] - 22s 371us/step - loss: 0.0091 - acc: 0.9973 - val_loss: 0.0292 - val_acc: 0.9911
Epoch 10/10
60000/60000 [==============================] - 22s 368us/step - loss: 0.0079 - acc: 0.9975 - val_loss: 0.0208 - val_acc: 0.9936
Test loss: 0.020811693493883468
Test accuracy: 0.9936
0 None
1 0
2 1
3 1
0 None
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 7, in evalOneMax
    model = build_model(individual)
  File "/content/individual.py", line 85, in build_model
    outputs.append(l.evaluate([outputs[i - 1], outputs[l.bypass_index]]))
  File "/content/individual.py", line 21, in evaluate
    return func(prev_output)
  File "/usr/local/lib/python3.6/dist-packages/keras/engine/topology.py", line 594, in __call__
    self.build(input_shapes)
  File "/usr/local/lib/python3.6/dist-packages/keras/layers/merge.py", line 90, in build
    output_shape = self._compute_elemwise_op_output_shape(output_shape, shape)
  File "/usr/local/lib/python3.6/dist-packages/keras/layers/merge.py", line 61, in _compute_elemwise_op_output_shape
    str(shape1) + ' ' + str(shape2))
ValueError: Operands could not be broadcast together with shapes (28, 28, 64) (28, 28, 32)
1 0
2 1
3 None
4 None
5 None
6 None
7 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/10
60000/60000 [==============================] - 63s 1ms/step - loss: 0.3920 - acc: 0.8876 - val_loss: 0.0849 - val_acc: 0.9752
Epoch 2/10
60000/60000 [==============================] - 34s 562us/step - loss: 0.0710 - acc: 0.9792 - val_loss: 0.0650 - val_acc: 0.9792
Epoch 3/10
60000/60000 [==============================] - 34s 564us/step - loss: 0.0499 - acc: 0.9847 - val_loss: 0.0436 - val_acc: 0.9867
Epoch 4/10
60000/60000 [==============================] - 34s 563us/step - loss: 0.0395 - acc: 0.9875 - val_loss: 0.0397 - val_acc: 0.9865
Epoch 5/10
60000/60000 [==============================] - 34s 562us/step - loss: 0.0321 - acc: 0.9900 - val_loss: 0.0376 - val_acc: 0.9872
Epoch 6/10
60000/60000 [==============================] - 34s 563us/step - loss: 0.0271 - acc: 0.9916 - val_loss: 0.0492 - val_acc: 0.9846
Epoch 7/10
60000/60000 [==============================] - 34s 562us/step - loss: 0.0236 - acc: 0.9928 - val_loss: 0.0331 - val_acc: 0.9895
Epoch 8/10
60000/60000 [==============================] - 34s 562us/step - loss: 0.0211 - acc: 0.9937 - val_loss: 0.0255 - val_acc: 0.9912
Epoch 9/10
60000/60000 [==============================] - 34s 562us/step - loss: 0.0186 - acc: 0.9944 - val_loss: 0.0257 - val_acc: 0.9915
Epoch 10/10
60000/60000 [==============================] - 34s 562us/step - loss: 0.0162 - acc: 0.9948 - val_loss: 0.0506 - val_acc: 0.9845
Test loss: 0.050633543358917815
Test accuracy: 0.9845
0 None
1 0
2 1
3 None
4 None
5 None
6 None
7 None
8 7
9 None
Train on 60000 samples, validate on 10000 samples
Epoch 1/10
60000/60000 [==============================] - 58s 968us/step - loss: 0.1960 - acc: 0.9465 - val_loss: 0.0754 - val_acc: 0.9783
Epoch 2/10
60000/60000 [==============================] - 22s 362us/step - loss: 0.0442 - acc: 0.9866 - val_loss: 0.0306 - val_acc: 0.9895
Epoch 3/10
60000/60000 [==============================] - 23s 384us/step - loss: 0.0296 - acc: 0.9908 - val_loss: 0.0350 - val_acc: 0.9890
Epoch 4/10
60000/60000 [==============================] - 21s 348us/step - loss: 0.0232 - acc: 0.9931 - val_loss: 0.0373 - val_acc: 0.9880
Epoch 5/10
60000/60000 [==============================] - 22s 368us/step - loss: 0.0176 - acc: 0.9948 - val_loss: 0.0213 - val_acc: 0.9930
Epoch 6/10
60000/60000 [==============================] - 22s 359us/step - loss: 0.0144 - acc: 0.9954 - val_loss: 0.0261 - val_acc: 0.9910
Epoch 7/10
60000/60000 [==============================] - 22s 360us/step - loss: 0.0110 - acc: 0.9964 - val_loss: 0.0189 - val_acc: 0.9938
Epoch 8/10
60000/60000 [==============================] - 23s 382us/step - loss: 0.0088 - acc: 0.9975 - val_loss: 0.0193 - val_acc: 0.9942
Epoch 9/10
60000/60000 [==============================] - 22s 372us/step - loss: 0.0077 - acc: 0.9980 - val_loss: 0.0169 - val_acc: 0.9948
Epoch 10/10
60000/60000 [==============================] - 21s 356us/step - loss: 0.0061 - acc: 0.9982 - val_loss: 0.0192 - val_acc: 0.9949
Test loss: 0.019194880859399927
Test accuracy: 0.9949
  Evaluated 9 individuals
-- Generation 14 --
Traceback (most recent call last):
  File "<ipython-input-5-163e76b7d43d>", line 63, in mutCNNStructure
    func(individual)
  File "/content/individual.py", line 124, in remove_dropout
    ind.remove_layer('Dropout')
  File "/content/individual.py", line 42, in remove_layer
    chosen = self.sample_layer(class_name)
  File "/content/individual.py", line 39, in sample_layer
    raise RuntimeError('No {} layer is found.'.format(class_name))
RuntimeError: No Dropout layer is found.
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
/content/individual.py in <module>()
----> 1 main()

/content/individual.py in main()
     85                 continue
     86             else:
---> 87                 toolbox.mutate(mutant)
     88                 del mutant.fitness.values
     89 

/content/individual.py in mutCNNStructure(individual)
     61     try:
     62       individual.last_applied_operation = func.__name__
---> 63       func(individual)
     64     except RuntimeError:
     65       import traceback

/content/individual.py in remove_skip(ind)
    142 
    143 def remove_skip(ind):
--> 144   ind.remove_layer('Add')
    145 
    146 def add_concatenate(ind):

/content/individual.py in remove_layer(self, class_name)
     45     offset = 1
     46     for i in range(chosen_index + 1, len(self)):
---> 47       if self[i].bypass_index == chosen_index:
     48         self.pop(i)
     49         offset += 1

IndexError: list index out of range